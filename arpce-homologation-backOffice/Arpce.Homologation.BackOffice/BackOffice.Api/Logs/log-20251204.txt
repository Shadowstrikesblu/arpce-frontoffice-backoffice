2025-12-04 01:16:17.362 +01:00 [INF] Executed DbCommand (348ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [ArpceHomologation_BackOffice];
2025-12-04 01:16:17.510 +01:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ArpceHomologation_BackOffice] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-12-04 01:16:17.534 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-04 01:16:17.567 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-12-04 01:16:17.682 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-12-04 01:16:17.694 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-04 01:16:17.696 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-04 01:16:17.711 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-04 01:16:17.959 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminAccess] (
    [Id] uniqueidentifier NOT NULL,
    [Application] nvarchar(120) NOT NULL,
    [Groupe] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Page] nvarchar(120) NULL,
    [Type] nvarchar(120) NOT NULL,
    [Inactif] tinyint NULL,
    [Ajouter] tinyint NULL,
    [Valider] tinyint NULL,
    [Supprimer] tinyint NULL,
    [Imprimer] tinyint NULL,
    [Code] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_adminAccess] PRIMARY KEY ([Id])
);
2025-12-04 01:16:17.961 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminConnexions] (
    [Id] uniqueidentifier NOT NULL,
    [Utilisateur] nvarchar(60) NOT NULL,
    [DateConnexion] datetime NOT NULL,
    [Ip] nvarchar(60) NULL,
    CONSTRAINT [PK_adminConnexions] PRIMARY KEY ([Id])
);
2025-12-04 01:16:17.965 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminEvenementsTypes] (
    [Id] uniqueidentifier NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Code] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_adminEvenementsTypes] PRIMARY KEY ([Id])
);
2025-12-04 01:16:17.970 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AdminOptions] (
    [Id] uniqueidentifier NOT NULL,
    [JournalActivation] tinyint NULL,
    [EventConnexion] tinyint NULL,
    [EventOuverturePage] tinyint NULL,
    [EventChangementMotPasse] tinyint NULL,
    [EventModificationDonnees] tinyint NULL,
    [EventSuppressionDonnees] tinyint NULL,
    [EventImpression] tinyint NULL,
    [EventValidation] tinyint NULL,
    [JournalLimitation] tinyint NULL,
    [JournalTypeLimitation] tinyint NULL,
    [JournalDureeLimitation] int NULL,
    [JournalTypeDureeLimitation] tinyint NULL,
    [JournalTailleLimitation] int NULL,
    [LDAPAuthentificationActivation] tinyint NULL,
    [LDAPAuthentificationNomDomaine] nvarchar(60) NULL,
    [LDAPCreationAutoActivation] tinyint NULL,
    [LDAPCreationAutoNomServeur] nvarchar(60) NULL,
    [LDAPCreationAutoCompte] nvarchar(60) NULL,
    [LDAPCreationAutoPassword] nvarchar(60) NULL,
    [ReplicationActivation] tinyint NULL,
    [ReplicationNomServeur] nvarchar(60) NULL,
    [ReplicationCompte] nvarchar(60) NULL,
    [ReplicationPassword] nvarchar(60) NULL,
    CONSTRAINT [PK_AdminOptions] PRIMARY KEY ([Id])
);
2025-12-04 01:16:17.992 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminProfils] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_adminProfils] PRIMARY KEY ([Id])
);
2025-12-04 01:16:17.995 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminReporting] (
    [Id] uniqueidentifier NOT NULL,
    [Application] nvarchar(120) NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Inactif] tinyint NULL,
    CONSTRAINT [PK_adminReporting] PRIMARY KEY ([Id])
);
2025-12-04 01:16:17.997 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminUtilisateurTypes] (
    [Id] uniqueidentifier NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    CONSTRAINT [PK_adminUtilisateurTypes] PRIMARY KEY ([Id])
);
2025-12-04 01:16:18.001 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [categoriesEquipements] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [TypeEquipement] nvarchar(50) NOT NULL,
    [TypeClient] nvarchar(50) NOT NULL,
    [FormuleHomologation] nvarchar(255) NULL,
    [QuantiteReference] int NULL,
    [TarifEtude] money NULL,
    [TarifHomologation] tinyint NULL,
    [FraisHomologationParLot] tinyint NULL,
    [FraisHomologationQuantiteParLot] int NULL,
    [TarifControle] money NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_categoriesEquipements] PRIMARY KEY ([Id])
);
2025-12-04 01:16:18.637 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [clients] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(30) NOT NULL,
    [RaisonSociale] nvarchar(120) NOT NULL,
    [RegistreCommerce] nvarchar(60) NULL,
    [MotPasse] nvarchar(255) NULL,
    [ChangementMotPasse] tinyint NULL,
    [Desactive] tinyint NULL,
    [ContactNom] nvarchar(60) NULL,
    [ContactTelephone] nvarchar(30) NULL,
    [ContactFonction] nvarchar(60) NULL,
    [Email] nvarchar(120) NULL,
    [Adresse] nvarchar(255) NULL,
    [Bp] nvarchar(60) NULL,
    [Ville] nvarchar(100) NULL,
    [Pays] nvarchar(100) NULL,
    [Remarques] nvarchar(512) NULL,
    [TypeClient] nvarchar(20) NOT NULL DEFAULT N'Entreprise',
    [NiveauValidation] int NOT NULL DEFAULT 0,
    [IsVerified] bit NOT NULL DEFAULT CAST(0 AS bit),
    [VerificationCode] nvarchar(6) NULL,
    [VerificationTokenExpiry] datetime2 NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_clients] PRIMARY KEY ([Id])
);
2025-12-04 01:16:18.640 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [modesReglements] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [MobileBanking] tinyint NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_modesReglements] PRIMARY KEY ([Id])
);
2025-12-04 01:16:19.336 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [motifsRejets] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_motifsRejets] PRIMARY KEY ([Id])
);
2025-12-04 01:16:19.338 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [propositions] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_propositions] PRIMARY KEY ([Id])
);
2025-12-04 01:16:19.341 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [statuts] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    CONSTRAINT [PK_statuts] PRIMARY KEY ([Id])
);
2025-12-04 01:16:19.344 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminProfilsAcces] (
    [IdProfil] uniqueidentifier NOT NULL,
    [IdAccess] uniqueidentifier NOT NULL,
    [Ajouter] tinyint NULL,
    [Valider] tinyint NULL,
    [Supprimer] tinyint NULL,
    [Imprimer] tinyint NULL,
    CONSTRAINT [PK_adminProfilsAcces] PRIMARY KEY ([IdProfil], [IdAccess]),
    CONSTRAINT [FK_adminProfilsAcces_adminAccess_IdAccess] FOREIGN KEY ([IdAccess]) REFERENCES [adminAccess] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_adminProfilsAcces_adminProfils_IdProfil] FOREIGN KEY ([IdProfil]) REFERENCES [adminProfils] ([Id]) ON DELETE CASCADE
);
2025-12-04 01:16:20.211 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminProfilsUtilisateursLDAP] (
    [Utilisateur] nvarchar(120) NOT NULL,
    [IdProfil] uniqueidentifier NOT NULL,
    CONSTRAINT [PK_adminProfilsUtilisateursLDAP] PRIMARY KEY ([Utilisateur], [IdProfil]),
    CONSTRAINT [FK_adminProfilsUtilisateursLDAP_adminProfils_IdProfil] FOREIGN KEY ([IdProfil]) REFERENCES [adminProfils] ([Id]) ON DELETE CASCADE
);
2025-12-04 01:16:20.216 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AdminUtilisateurs] (
    [Id] uniqueidentifier NOT NULL,
    [IdProfil] uniqueidentifier NULL,
    [IdUtilisateurType] uniqueidentifier NOT NULL,
    [Compte] nvarchar(100) NOT NULL,
    [Nom] nvarchar(100) NOT NULL,
    [Prenoms] nvarchar(150) NULL,
    [MotPasse] nvarchar(255) NULL,
    [ChangementMotPasse] bit NOT NULL,
    [Desactive] bit NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [DerniereConnexion] datetime NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    [AdminProfilsId] uniqueidentifier NULL,
    CONSTRAINT [PK_AdminUtilisateurs] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AdminUtilisateurs_adminProfils_AdminProfilsId] FOREIGN KEY ([AdminProfilsId]) REFERENCES [adminProfils] ([Id]),
    CONSTRAINT [FK_AdminUtilisateurs_adminProfils_IdProfil] FOREIGN KEY ([IdProfil]) REFERENCES [adminProfils] ([Id]) ON DELETE SET NULL,
    CONSTRAINT [FK_AdminUtilisateurs_adminUtilisateurTypes_IdUtilisateurType] FOREIGN KEY ([IdUtilisateurType]) REFERENCES [adminUtilisateurTypes] ([Id]) ON DELETE NO ACTION
);
2025-12-04 01:16:20.220 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [dossiers] (
    [Id] uniqueidentifier NOT NULL,
    [IdClient] uniqueidentifier NOT NULL,
    [IdStatut] uniqueidentifier NOT NULL,
    [IdModeReglement] uniqueidentifier NULL,
    [DateOuverture] date NOT NULL,
    [Numero] nvarchar(30) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [IdAgentInstructeur] uniqueidentifier NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_dossiers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_dossiers_AdminUtilisateurs_IdAgentInstructeur] FOREIGN KEY ([IdAgentInstructeur]) REFERENCES [AdminUtilisateurs] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_dossiers_clients_IdClient] FOREIGN KEY ([IdClient]) REFERENCES [clients] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_dossiers_modesReglements_IdModeReglement] FOREIGN KEY ([IdModeReglement]) REFERENCES [modesReglements] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_dossiers_statuts_IdStatut] FOREIGN KEY ([IdStatut]) REFERENCES [statuts] ([Id]) ON DELETE NO ACTION
);
2025-12-04 01:16:20.673 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminJournal] (
    [Id] uniqueidentifier NOT NULL,
    [IdEvenementType] uniqueidentifier NOT NULL,
    [Application] nvarchar(120) NOT NULL,
    [AdresseIP] nvarchar(120) NOT NULL,
    [Utilisateur] nvarchar(120) NOT NULL,
    [DateEvenement] datetime NOT NULL,
    [Page] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(255) NULL,
    [IdDossier] uniqueidentifier NULL,
    [DossierId] uniqueidentifier NULL,
    CONSTRAINT [PK_adminJournal] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_adminJournal_adminEvenementsTypes_IdEvenementType] FOREIGN KEY ([IdEvenementType]) REFERENCES [adminEvenementsTypes] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_adminJournal_dossiers_DossierId] FOREIGN KEY ([DossierId]) REFERENCES [dossiers] ([Id])
);
2025-12-04 01:16:20.676 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [commentaires] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [DateCommentaire] datetime NOT NULL,
    [commentaire] nvarchar(512) NULL,
    [NomInstructeur] nvarchar(60) NULL,
    [Proposition] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_commentaires] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_commentaires_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE
);
2025-12-04 01:16:21.030 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [demandes] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [IdCategorie] uniqueidentifier NULL,
    [IdMotifRejet] uniqueidentifier NULL,
    [IdProposition] uniqueidentifier NULL,
    [NumeroDemande] nvarchar(12) NULL,
    [Equipement] nvarchar(120) NULL,
    [Modele] nvarchar(120) NULL,
    [Marque] nvarchar(120) NULL,
    [Fabricant] nvarchar(120) NULL,
    [Type] nvarchar(120) NULL,
    [Description] nvarchar(512) NULL,
    [QuantiteEquipements] int NULL,
    [ContactNom] nvarchar(60) NULL,
    [ContactEmail] nvarchar(60) NULL,
    [PrixUnitaire] money NULL,
    [EstHomologable] bit NOT NULL DEFAULT CAST(1 AS bit),
    [Remise] decimal(5,2) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_demandes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_demandes_categoriesEquipements_IdCategorie] FOREIGN KEY ([IdCategorie]) REFERENCES [categoriesEquipements] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_demandes_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_demandes_motifsRejets_IdMotifRejet] FOREIGN KEY ([IdMotifRejet]) REFERENCES [motifsRejets] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_demandes_propositions_IdProposition] FOREIGN KEY ([IdProposition]) REFERENCES [propositions] ([Id]) ON DELETE NO ACTION
);
2025-12-04 01:16:21.353 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [devis] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [Date] date NOT NULL,
    [MontantEtude] money NOT NULL,
    [MontantHomologation] money NULL,
    [MontantControle] money NULL,
    [PaiementOk] tinyint NULL,
    [PaiementMobileId] nvarchar(60) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_devis] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_devis_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE
);
2025-12-04 01:16:21.356 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [documentsDossiers] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [Nom] nvarchar(120) NULL,
    [Type] tinyint NULL,
    [Donnees] varbinary(max) NULL,
    [Extension] nvarchar(12) NOT NULL,
    [FilePath] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_documentsDossiers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_documentsDossiers_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE
);
2025-12-04 01:16:21.359 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [attestations] (
    [Id] uniqueidentifier NOT NULL,
    [IdDemande] uniqueidentifier NOT NULL,
    [DateDelivrance] date NOT NULL,
    [DateExpiration] date NOT NULL,
    [Donnees] varbinary(max) NULL,
    [Extension] nvarchar(12) NOT NULL,
    CONSTRAINT [PK_attestations] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_attestations_demandes_IdDemande] FOREIGN KEY ([IdDemande]) REFERENCES [demandes] ([Id]) ON DELETE CASCADE
);
2025-12-04 01:16:21.764 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [documentsDemandes] (
    [Id] uniqueidentifier NOT NULL,
    [IdDemande] uniqueidentifier NOT NULL,
    [Nom] nvarchar(120) NULL,
    [Donnees] varbinary(max) NULL,
    [Extension] nvarchar(12) NOT NULL,
    [FilePath] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] datetime NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] datetime NULL,
    CONSTRAINT [PK_documentsDemandes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_documentsDemandes_demandes_IdDemande] FOREIGN KEY ([IdDemande]) REFERENCES [demandes] ([Id]) ON DELETE CASCADE
);
2025-12-04 01:16:21.808 +01:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminEvenementsTypes]'))
    SET IDENTITY_INSERT [adminEvenementsTypes] ON;
INSERT INTO [adminEvenementsTypes] ([Id], [Code], [Libelle])
VALUES ('085d97f6-d7a9-45b4-b398-3a4459c182c7', N'CREATION', N'Création de données'),
('0c9f080c-ae78-4506-b182-bcadeab65532', N'MODIFICATION', N'Connexion utilisateur'),
('32a47796-2314-48eb-a05a-ce1c67577317', N'VALIDATION', N'Validation de processus'),
('62c5b7a4-de3a-45b1-980d-b31621236c20', N'COMMUNICATION', N'Envoi de communication'),
('934b7df9-7dc8-462b-86df-0cfb945ddf43', N'MODIFICATION', N'Modification de données'),
('9e9f89f7-6c93-4ceb-bbc3-9fcfb64c871a', N'SECURITE', N'Action de sécurité'),
('a5645866-5c3e-4755-948d-a1ee018d6217', N'ATTRIBUTION', N'Attribution de droits/profils'),
('c4039001-93fe-4ee2-a007-5b95128bdba2', N'QUALIFICATION', N'Qualification de données'),
('d6d88430-4acd-4114-99e9-098cffd3c038', N'CONNEXION', N'Modification'),
('e7b9e63f-ef5e-486e-8cf4-848a78191ba8', N'SUPPRESSION', N'Suppression de données');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminEvenementsTypes]'))
    SET IDENTITY_INSERT [adminEvenementsTypes] OFF;
2025-12-04 01:16:22.216 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminUtilisateurTypes]'))
    SET IDENTITY_INSERT [adminUtilisateurTypes] ON;
INSERT INTO [adminUtilisateurTypes] ([Id], [Libelle])
VALUES ('21506b36-ce47-49a8-8393-85504d46fbc0', N'Utilisateur Standard'),
('5b9a841b-40c3-46f5-847b-321703746a62', N'Auditeur'),
('7e5b7d94-4f5d-4eff-9983-c8f846d3cee6', N'Administrateur');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminUtilisateurTypes]'))
    SET IDENTITY_INSERT [adminUtilisateurTypes] OFF;
2025-12-04 01:16:22.233 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'DateCreation', N'DateModification', N'Libelle', N'MobileBanking', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[modesReglements]'))
    SET IDENTITY_INSERT [modesReglements] ON;
INSERT INTO [modesReglements] ([Id], [Code], [DateCreation], [DateModification], [Libelle], [MobileBanking], [Remarques], [UtilisateurCreation], [UtilisateurModification])
VALUES ('47702c0a-3439-4de3-8cae-9292697a6453', N'Especes', NULL, NULL, N'Espèces', CAST(0 AS tinyint), NULL, NULL, NULL),
('9f10fbf3-987c-4968-b6f6-caae8b87bf80', N'Virement', NULL, NULL, N'Virement bancaire', CAST(0 AS tinyint), NULL, NULL, NULL),
('c4e94470-6cda-4fdf-bca5-20f398434296', N'MobileBanking', NULL, NULL, N'Paiement mobile', CAST(1 AS tinyint), NULL, NULL, NULL),
('c5e27342-5f35-4a83-8fa9-c173c8748223', N'Cheque', NULL, NULL, N'Chèque', CAST(0 AS tinyint), NULL, NULL, NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'DateCreation', N'DateModification', N'Libelle', N'MobileBanking', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[modesReglements]'))
    SET IDENTITY_INSERT [modesReglements] OFF;
2025-12-04 01:16:22.511 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[statuts]'))
    SET IDENTITY_INSERT [statuts] ON;
INSERT INTO [statuts] ([Id], [Code], [Libelle])
VALUES ('1c7008c1-0dcc-4615-95f3-a68318f1cb08', N'ApprobationInstruction', N'Envoyé pour approbation'),
('2a95e411-5d2c-42a8-94d1-8b98770c3139', N'RefusDossier', N'Refus de la demande'),
('4423a983-2316-477a-8949-bdda30e61cb8', N'DevisValide', N'Devis validé par client'),
('650b2183-0b13-4f61-8da8-be6df7f4a247', N'DevisRefuser', N'Devis refusé par client'),
('663e1659-7732-4123-9f16-a49dd1d3159b', N'NouveauDossier', N'Nouvelle demande'),
('67c00a9a-36eb-4278-b4b6-5c6a2c4f0b5b', N'PaiementRejete', N'Paiement non accepté'),
('7856d7a5-d887-4928-9919-cf39806644c2', N'DevisValideSC', N'Devis validé par Chef Service'),
('801a01d7-ce46-461a-9c3b-1d74b9c19aac', N'Instruction', N'En cours d''instruction'),
('8ac61be4-c29b-4b1c-bab9-07b6fadf023d', N'PaiementExpirer', N'Paiement expiré'),
('8d56a112-72be-4a23-b638-3752a80d5193', N'DossierSignature', N'Attestation en signature'),
('8f2468ad-c6ba-40bd-8b7f-cab2f9130b4e', N'DevisCreer', N'Devis créé'),
('90d10281-1e81-410b-884d-f03ef75cb584', N'DevisEmit', N'Devis émis'),
('d5b65fea-b0a0-418b-9f14-36767b34edab', N'DevisValideTr', N'Devis validé par Trésorerie'),
('d7aa0b4f-cf4b-47e4-b3f7-7c08f05e8a31', N'DossierSigner', N'Attestation signée'),
('f046322e-5bf3-415f-acd8-5da44ae1fc88', N'DossierPayer', N'Paiement effectué'),
('fb0e4bfe-40f2-44df-acc6-6a412d306d44', N'InstructionApprouve', N'Instruction Approuvée');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[statuts]'))
    SET IDENTITY_INSERT [statuts] OFF;
2025-12-04 01:16:22.708 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AdminProfilsId', N'ChangementMotPasse', N'Compte', N'DateCreation', N'DateModification', N'DerniereConnexion', N'Desactive', N'IdProfil', N'IdUtilisateurType', N'MotPasse', N'Nom', N'Prenoms', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[AdminUtilisateurs]'))
    SET IDENTITY_INSERT [AdminUtilisateurs] ON;
INSERT INTO [AdminUtilisateurs] ([Id], [AdminProfilsId], [ChangementMotPasse], [Compte], [DateCreation], [DateModification], [DerniereConnexion], [Desactive], [IdProfil], [IdUtilisateurType], [MotPasse], [Nom], [Prenoms], [Remarques], [UtilisateurCreation], [UtilisateurModification])
VALUES ('45984c40-427b-45bc-a646-b47438f1d8b3', NULL, CAST(1 AS bit), N'admin', '2025-01-01T00:00:00.000', NULL, NULL, CAST(0 AS bit), NULL, '7e5b7d94-4f5d-4eff-9983-c8f846d3cee6', N'$2a$11$2RRchS584NgwaJZiqTl14OX3MLzDmF5BDuonOU/gHw4kEHBFCBW4a', N'Administrateur', N'ARPCE', NULL, N'SYSTEM_SEED', NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AdminProfilsId', N'ChangementMotPasse', N'Compte', N'DateCreation', N'DateModification', N'DerniereConnexion', N'Desactive', N'IdProfil', N'IdUtilisateurType', N'MotPasse', N'Nom', N'Prenoms', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[AdminUtilisateurs]'))
    SET IDENTITY_INSERT [AdminUtilisateurs] OFF;
2025-12-04 01:16:22.709 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminJournal_DossierId] ON [adminJournal] ([DossierId]);
2025-12-04 01:16:22.710 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminJournal_IdEvenementType] ON [adminJournal] ([IdEvenementType]);
2025-12-04 01:16:22.983 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminProfilsAcces_IdAccess] ON [adminProfilsAcces] ([IdAccess]);
2025-12-04 01:16:22.984 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminProfilsUtilisateursLDAP_IdProfil] ON [adminProfilsUtilisateursLDAP] ([IdProfil]);
2025-12-04 01:16:22.990 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AdminUtilisateurs_AdminProfilsId] ON [AdminUtilisateurs] ([AdminProfilsId]);
2025-12-04 01:16:22.993 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AdminUtilisateurs_Compte] ON [AdminUtilisateurs] ([Compte]);
2025-12-04 01:16:22.997 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AdminUtilisateurs_IdProfil] ON [AdminUtilisateurs] ([IdProfil]);
2025-12-04 01:16:23.001 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AdminUtilisateurs_IdUtilisateurType] ON [AdminUtilisateurs] ([IdUtilisateurType]);
2025-12-04 01:16:23.003 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_attestations_IdDemande] ON [attestations] ([IdDemande]);
2025-12-04 01:16:23.005 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_commentaires_IdDossier] ON [commentaires] ([IdDossier]);
2025-12-04 01:16:23.006 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdCategorie] ON [demandes] ([IdCategorie]);
2025-12-04 01:16:23.008 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdDossier] ON [demandes] ([IdDossier]);
2025-12-04 01:16:23.009 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdMotifRejet] ON [demandes] ([IdMotifRejet]);
2025-12-04 01:16:23.011 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdProposition] ON [demandes] ([IdProposition]);
2025-12-04 01:16:23.248 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_devis_IdDossier] ON [devis] ([IdDossier]);
2025-12-04 01:16:23.249 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_documentsDemandes_IdDemande] ON [documentsDemandes] ([IdDemande]);
2025-12-04 01:16:23.251 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_documentsDossiers_IdDossier] ON [documentsDossiers] ([IdDossier]);
2025-12-04 01:16:23.253 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdAgentInstructeur] ON [dossiers] ([IdAgentInstructeur]);
2025-12-04 01:16:23.256 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdClient] ON [dossiers] ([IdClient]);
2025-12-04 01:16:23.258 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdModeReglement] ON [dossiers] ([IdModeReglement]);
2025-12-04 01:16:23.259 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdStatut] ON [dossiers] ([IdStatut]);
2025-12-04 01:16:23.262 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251204001551_Initialisation', N'9.0.11');
2025-12-04 01:16:23.272 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-12-04 01:17:22.692 +01:00 [INF] Now listening on: https://localhost:7238
2025-12-04 01:17:22.737 +01:00 [INF] Now listening on: http://localhost:5126
2025-12-04 01:17:22.846 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-04 01:17:22.849 +01:00 [INF] Hosting environment: Development
2025-12-04 01:17:22.851 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api
2025-12-04 01:18:16.077 +01:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-12-04 01:18:19.311 +01:00 [INF] Executed DbCommand (168ms) [Parameters=[@__request_Compte_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AdminProfilsId], [a].[ChangementMotPasse], [a].[Compte], [a].[DateCreation], [a].[DateModification], [a].[DerniereConnexion], [a].[Desactive], [a].[IdProfil], [a].[IdUtilisateurType], [a].[MotPasse], [a].[Nom], [a].[Prenoms], [a].[Remarques], [a].[UtilisateurCreation], [a].[UtilisateurModification]
FROM [AdminUtilisateurs] AS [a]
WHERE [a].[Compte] = @__request_Compte_0
2025-12-04 01:18:20.179 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AdminUtilisateurs] SET [DerniereConnexion] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-12-04 01:20:33.572 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
2025-12-04 01:44:27.325 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
2025-12-04 01:44:27.536 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[DateCreation], [d0].[DateModification], [d0].[DateOuverture], [d0].[IdAgentInstructeur], [d0].[IdClient], [d0].[IdModeReglement], [d0].[IdStatut], [d0].[Libelle], [d0].[Numero], [d0].[UtilisateurCreation], [d0].[UtilisateurModification], [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville], [s].[Id], [s].[Code], [s].[Libelle], [d1].[Id], [d1].[ContactEmail], [d1].[ContactNom], [d1].[DateCreation], [d1].[DateModification], [d1].[Description], [d1].[Equipement], [d1].[EstHomologable], [d1].[Fabricant], [d1].[IdCategorie], [d1].[IdDossier], [d1].[IdMotifRejet], [d1].[IdProposition], [d1].[Marque], [d1].[Modele], [d1].[NumeroDemande], [d1].[PrixUnitaire], [d1].[QuantiteEquipements], [d1].[Remise], [d1].[Type], [d1].[UtilisateurCreation], [d1].[UtilisateurModification]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdAgentInstructeur], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    ORDER BY [d].[DateCreation] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [clients] AS [c] ON [d0].[IdClient] = [c].[Id]
INNER JOIN [statuts] AS [s] ON [d0].[IdStatut] = [s].[Id]
LEFT JOIN [demandes] AS [d1] ON [d0].[Id] = [d1].[IdDossier]
ORDER BY [d0].[DateCreation] DESC, [d0].[Id], [c].[Id], [s].[Id]
2025-12-04 01:45:33.928 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_DemandeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[ContactEmail], [d].[ContactNom], [d].[DateCreation], [d].[DateModification], [d].[Description], [d].[Equipement], [d].[EstHomologable], [d].[Fabricant], [d].[IdCategorie], [d].[IdDossier], [d].[IdMotifRejet], [d].[IdProposition], [d].[Marque], [d].[Modele], [d].[NumeroDemande], [d].[PrixUnitaire], [d].[QuantiteEquipements], [d].[Remise], [d].[Type], [d].[UtilisateurCreation], [d].[UtilisateurModification], [d0].[Id], [d0].[DateCreation], [d0].[DateModification], [d0].[DateOuverture], [d0].[IdAgentInstructeur], [d0].[IdClient], [d0].[IdModeReglement], [d0].[IdStatut], [d0].[Libelle], [d0].[Numero], [d0].[UtilisateurCreation], [d0].[UtilisateurModification]
FROM [demandes] AS [d]
INNER JOIN [dossiers] AS [d0] ON [d].[IdDossier] = [d0].[Id]
WHERE [d].[Id] = @__request_DemandeId_0
2025-12-04 01:45:34.097 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'DossierSigne'
2025-12-04 01:45:34.168 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Date), @p2='?' (DbType = Date), @p3='?' (Size = -1) (DbType = Binary), @p4='?' (Size = 12), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [attestations] ([Id], [DateDelivrance], [DateExpiration], [Donnees], [Extension], [IdDemande])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-12-04 01:45:34.189 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__eventTypeCode_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Code], [a].[Libelle]
FROM [adminEvenementsTypes] AS [a]
WHERE [a].[Code] = @__eventTypeCode_0
2025-12-04 01:45:58.237 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@__targetStatus_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [attestations] AS [a]
INNER JOIN [demandes] AS [d] ON [a].[IdDemande] = [d].[Id]
INNER JOIN [dossiers] AS [d0] ON [d].[IdDossier] = [d0].[Id]
INNER JOIN [statuts] AS [s] ON [d0].[IdStatut] = [s].[Id]
WHERE [s].[Code] = @__targetStatus_0
2025-12-04 01:45:58.267 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__targetStatus_0='?' (Size = 120), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[DateDelivrance], [a].[DateExpiration], [a].[Donnees], [a].[Extension], [a].[IdDemande], [d].[Id], [d].[ContactEmail], [d].[ContactNom], [d].[DateCreation], [d].[DateModification], [d].[Description], [d].[Equipement], [d].[EstHomologable], [d].[Fabricant], [d].[IdCategorie], [d].[IdDossier], [d].[IdMotifRejet], [d].[IdProposition], [d].[Marque], [d].[Modele], [d].[NumeroDemande], [d].[PrixUnitaire], [d].[QuantiteEquipements], [d].[Remise], [d].[Type], [d].[UtilisateurCreation], [d].[UtilisateurModification], [d0].[Id], [d0].[DateCreation], [d0].[DateModification], [d0].[DateOuverture], [d0].[IdAgentInstructeur], [d0].[IdClient], [d0].[IdModeReglement], [d0].[IdStatut], [d0].[Libelle], [d0].[Numero], [d0].[UtilisateurCreation], [d0].[UtilisateurModification]
FROM [attestations] AS [a]
INNER JOIN [demandes] AS [d] ON [a].[IdDemande] = [d].[Id]
INNER JOIN [dossiers] AS [d0] ON [d].[IdDossier] = [d0].[Id]
INNER JOIN [statuts] AS [s] ON [d0].[IdStatut] = [s].[Id]
WHERE [s].[Code] = @__targetStatus_0
ORDER BY [a].[DateDelivrance] DESC
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
2025-12-04 01:51:50.208 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_DemandeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[ContactEmail], [d].[ContactNom], [d].[DateCreation], [d].[DateModification], [d].[Description], [d].[Equipement], [d].[EstHomologable], [d].[Fabricant], [d].[IdCategorie], [d].[IdDossier], [d].[IdMotifRejet], [d].[IdProposition], [d].[Marque], [d].[Modele], [d].[NumeroDemande], [d].[PrixUnitaire], [d].[QuantiteEquipements], [d].[Remise], [d].[Type], [d].[UtilisateurCreation], [d].[UtilisateurModification], [d0].[Id], [d0].[DateCreation], [d0].[DateModification], [d0].[DateOuverture], [d0].[IdAgentInstructeur], [d0].[IdClient], [d0].[IdModeReglement], [d0].[IdStatut], [d0].[Libelle], [d0].[Numero], [d0].[UtilisateurCreation], [d0].[UtilisateurModification]
FROM [demandes] AS [d]
INNER JOIN [dossiers] AS [d0] ON [d].[IdDossier] = [d0].[Id]
WHERE [d].[Id] = @__request_DemandeId_0
2025-12-04 01:51:50.219 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'DossierSigne'
2025-12-04 01:51:50.238 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Date), @p2='?' (DbType = Date), @p3='?' (Size = -1) (DbType = Binary), @p4='?' (Size = 12), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [attestations] ([Id], [DateDelivrance], [DateExpiration], [Donnees], [Extension], [IdDemande])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-12-04 01:51:50.248 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__eventTypeCode_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Code], [a].[Libelle]
FROM [adminEvenementsTypes] AS [a]
WHERE [a].[Code] = @__eventTypeCode_0
2025-12-04 01:53:46.001 +01:00 [ERR] Une exception non gérée a été interceptée.
System.ArgumentException: Type de document non valide. Utilisez 'dossier' ou 'demande'.
   at BackOffice.Application.Features.Demandes.Queries.DownloadDocument.DownloadDocumentQueryHandler.Handle(DownloadDocumentQuery request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Application\Features\Demandes\Queries\DownloadDocument\DownloadDocumentQueryHandler.cs:line 62
   at BackOffice.Api.Controllers.DemandesController.DownloadDocument(String type, Guid id) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Controllers\DemandesController.cs:line 79
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at BackOffice.Api.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Middleware\ErrorHandlingMiddleware.cs:line 21
2025-12-04 01:56:26.249 +01:00 [ERR] Une exception non gérée a été interceptée.
System.ArgumentException: Type de document non valide. Utilisez 'dossier' ou 'demande'.
   at BackOffice.Application.Features.Demandes.Queries.DownloadDocument.DownloadDocumentQueryHandler.Handle(DownloadDocumentQuery request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Application\Features\Demandes\Queries\DownloadDocument\DownloadDocumentQueryHandler.cs:line 62
   at BackOffice.Api.Controllers.DocumentsController.DownloadDocument(String type, Guid id) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Controllers\DocumentsController.cs:line 62
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at BackOffice.Api.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Middleware\ErrorHandlingMiddleware.cs:line 21
2025-12-04 01:56:41.131 +01:00 [ERR] Une exception non gérée a été interceptée.
System.ArgumentException: Type de document non valide. Utilisez 'dossier' ou 'demande'.
   at BackOffice.Application.Features.Demandes.Queries.DownloadDocument.DownloadDocumentQueryHandler.Handle(DownloadDocumentQuery request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Application\Features\Demandes\Queries\DownloadDocument\DownloadDocumentQueryHandler.cs:line 62
   at BackOffice.Api.Controllers.DemandesController.DownloadDocument(String type, Guid id) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Controllers\DemandesController.cs:line 79
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at BackOffice.Api.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Middleware\ErrorHandlingMiddleware.cs:line 21
2025-12-04 02:15:31.763 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdAgentInstructeur], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
FROM [dossiers] AS [d]
WHERE [d].[Id] = @__p_0
2025-12-04 02:15:31.821 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 23), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2025-12-04 02:15:31.842 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'DevisPaiement'
2025-12-04 02:15:31.855 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__eventTypeCode_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Code], [a].[Libelle]
FROM [adminEvenementsTypes] AS [a]
WHERE [a].[Code] = @__eventTypeCode_0
2025-12-04 02:16:59.636 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_DocumentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[Donnees], [d].[Extension], [d].[FilePath], [d].[IdDossier], [d].[Nom], [d].[Type], [d].[UtilisateurCreation], [d].[UtilisateurModification]
FROM [documentsDossiers] AS [d]
WHERE [d].[Id] = @__request_DocumentId_0
2025-12-04 02:17:02.650 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_DocumentId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[Donnees], [d].[Extension], [d].[FilePath], [d].[IdDossier], [d].[Nom], [d].[Type], [d].[UtilisateurCreation], [d].[UtilisateurModification]
FROM [documentsDossiers] AS [d]
WHERE [d].[Id] = @__request_DocumentId_0
2025-12-04 02:21:11.027 +00:00 [FTL] L'application BackOffice s'est arrêtée de manière inattendue sur le VPS.
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at System.Diagnostics.DiagnosticSource.Write[T](String name, T value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in C:\Users\Administrator\Downloads\Backend\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Program.cs:line 138
2025-12-04 02:22:10.757 +00:00 [FTL] L'application BackOffice s'est arrêtée de manière inattendue sur le VPS.
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at System.Diagnostics.DiagnosticSource.Write[T](String name, T value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in C:\Users\Administrator\Downloads\Backend\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Program.cs:line 138
2025-12-04 02:22:34.909 +00:00 [FTL] L'application BackOffice s'est arrêtée de manière inattendue sur le VPS.
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at System.Diagnostics.DiagnosticSource.Write[T](String name, T value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in C:\Users\Administrator\Downloads\Backend\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Program.cs:line 138
