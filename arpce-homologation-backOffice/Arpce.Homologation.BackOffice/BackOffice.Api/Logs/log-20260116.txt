2026-01-16 00:00:12.180 +01:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2026-01-16 00:00:16.336 +01:00 [INF] Executed DbCommand (76ms) [Parameters=[@__request_Compte_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AdminProfilsId], [a].[ChangementMotPasse], [a].[Compte], [a].[DateCreation], [a].[DateModification], [a].[DerniereConnexion], [a].[Desactive], [a].[IdProfil], [a].[IdUtilisateurType], [a].[MotPasse], [a].[Nom], [a].[Prenoms], [a].[Remarques], [a].[UtilisateurCreation], [a].[UtilisateurModification], [a0].[Id], [a0].[Code], [a0].[DateCreation], [a0].[DateModification], [a0].[Libelle], [a0].[Remarques], [a0].[UtilisateurCreation], [a0].[UtilisateurModification]
FROM [AdminUtilisateurs] AS [a]
LEFT JOIN [adminProfils] AS [a0] ON [a].[IdProfil] = [a0].[Id]
WHERE [a].[Compte] = @__request_Compte_0
2026-01-16 00:00:16.792 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AdminUtilisateurs] SET [DerniereConnexion] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2026-01-16 00:00:58.727 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
2026-01-16 00:00:58.797 +01:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2026-01-16 00:00:58.857 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[DateCreation], [d0].[DateModification], [d0].[DateOuverture], [d0].[IdAgentInstructeur], [d0].[IdClient], [d0].[IdModeReglement], [d0].[IdStatut], [d0].[Libelle], [d0].[Numero], [d0].[UtilisateurCreation], [d0].[UtilisateurModification], [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville], [s].[Id], [s].[Code], [s].[Libelle], [d1].[Id], [d1].[DateCreation], [d1].[DateModification], [d1].[Donnees], [d1].[Extension], [d1].[FilePath], [d1].[IdDossier], [d1].[Nom], [d1].[Type], [d1].[UtilisateurCreation], [d1].[UtilisateurModification], [s0].[Id], [s0].[ContactEmail], [s0].[ContactNom], [s0].[DateCreation], [s0].[DateModification], [s0].[Description], [s0].[Equipement], [s0].[EstHomologable], [s0].[Fabricant], [s0].[IdCategorie], [s0].[IdDossier], [s0].[IdMotifRejet], [s0].[IdProposition], [s0].[Marque], [s0].[Modele], [s0].[NumeroDemande], [s0].[PrixUnitaire], [s0].[QuantiteEquipements], [s0].[Remise], [s0].[Type], [s0].[UtilisateurCreation], [s0].[UtilisateurModification], [s0].[Id0], [s0].[DateCreation0], [s0].[DateModification0], [s0].[Donnees], [s0].[Extension], [s0].[FilePath], [s0].[IdDemande], [s0].[Nom], [s0].[UtilisateurCreation0], [s0].[UtilisateurModification0]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdAgentInstructeur], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    ORDER BY [d].[DateCreation] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [clients] AS [c] ON [d0].[IdClient] = [c].[Id]
INNER JOIN [statuts] AS [s] ON [d0].[IdStatut] = [s].[Id]
LEFT JOIN [documentsDossiers] AS [d1] ON [d0].[Id] = [d1].[IdDossier]
LEFT JOIN (
    SELECT [d2].[Id], [d2].[ContactEmail], [d2].[ContactNom], [d2].[DateCreation], [d2].[DateModification], [d2].[Description], [d2].[Equipement], [d2].[EstHomologable], [d2].[Fabricant], [d2].[IdCategorie], [d2].[IdDossier], [d2].[IdMotifRejet], [d2].[IdProposition], [d2].[Marque], [d2].[Modele], [d2].[NumeroDemande], [d2].[PrixUnitaire], [d2].[QuantiteEquipements], [d2].[Remise], [d2].[Type], [d2].[UtilisateurCreation], [d2].[UtilisateurModification], [d3].[Id] AS [Id0], [d3].[DateCreation] AS [DateCreation0], [d3].[DateModification] AS [DateModification0], [d3].[Donnees], [d3].[Extension], [d3].[FilePath], [d3].[IdDemande], [d3].[Nom], [d3].[UtilisateurCreation] AS [UtilisateurCreation0], [d3].[UtilisateurModification] AS [UtilisateurModification0]
    FROM [demandes] AS [d2]
    LEFT JOIN [documentsDemandes] AS [d3] ON [d2].[Id] = [d3].[IdDemande]
) AS [s0] ON [d0].[Id] = [s0].[IdDossier]
ORDER BY [d0].[DateCreation] DESC, [d0].[Id], [c].[Id], [s].[Id], [d1].[Id], [s0].[Id]
2026-01-16 01:43:37.915 +01:00 [INF] Now listening on: https://localhost:7238
2026-01-16 01:43:37.972 +01:00 [INF] Now listening on: http://localhost:5126
2026-01-16 01:43:38.154 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-16 01:43:38.180 +01:00 [INF] Hosting environment: Development
2026-01-16 01:43:38.191 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api
2026-01-16 01:44:12.290 +01:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2026-01-16 01:44:17.422 +01:00 [INF] Executed DbCommand (138ms) [Parameters=[@__request_Compte_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AdminProfilsId], [a].[ChangementMotPasse], [a].[Compte], [a].[DateCreation], [a].[DateModification], [a].[DerniereConnexion], [a].[Desactive], [a].[IdProfil], [a].[IdUtilisateurType], [a].[MotPasse], [a].[Nom], [a].[Prenoms], [a].[Remarques], [a].[UtilisateurCreation], [a].[UtilisateurModification], [a0].[Id], [a0].[Code], [a0].[DateCreation], [a0].[DateModification], [a0].[Libelle], [a0].[Remarques], [a0].[UtilisateurCreation], [a0].[UtilisateurModification]
FROM [AdminUtilisateurs] AS [a]
LEFT JOIN [adminProfils] AS [a0] ON [a].[IdProfil] = [a0].[Id]
WHERE [a].[Compte] = @__request_Compte_0
2026-01-16 01:44:17.890 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AdminUtilisateurs] SET [DerniereConnexion] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2026-01-16 01:47:49.200 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[ContactEmail], [d].[ContactNom], [d].[DateCreation], [d].[DateModification], [d].[Description], [d].[Equipement], [d].[EstHomologable], [d].[Fabricant], [d].[IdCategorie], [d].[IdDossier], [d].[IdMotifRejet], [d].[IdProposition], [d].[Marque], [d].[Modele], [d].[NumeroDemande], [d].[PrixUnitaire], [d].[QuantiteEquipements], [d].[Remise], [d].[Type], [d].[UtilisateurCreation], [d].[UtilisateurModification]
FROM [demandes] AS [d]
WHERE [d].[Id] = @__p_0
2026-01-16 01:54:00.177 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_TypeEquipement_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[Code], [c].[Libelle], [c].[TypeEquipement], [c].[TypeClient], [c].[FraisEtude], [c].[FraisHomologation], [c].[FraisControle], [c].[FormuleHomologation], [c].[QuantiteReference], [c].[Remarques]
FROM [categoriesEquipements] AS [c]
WHERE [c].[TypeEquipement] = @__request_TypeEquipement_0
2026-01-16 01:54:00.220 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'BackOffice.Infrastructure.Persistence.BackOfficeDbContext'.
System.InvalidCastException: Unable to cast object of type 'System.Byte' to type 'System.Decimal'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Decimal()
   at Microsoft.Data.SqlClient.SqlDataReader.GetDecimal(Int32 i)
   at lambda_method356(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Unable to cast object of type 'System.Byte' to type 'System.Decimal'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Decimal()
   at Microsoft.Data.SqlClient.SqlDataReader.GetDecimal(Int32 i)
   at lambda_method356(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-01-16 01:54:00.454 +01:00 [ERR] Une exception non gérée a été interceptée.
System.InvalidCastException: Unable to cast object of type 'System.Byte' to type 'System.Decimal'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Decimal()
   at Microsoft.Data.SqlClient.SqlDataReader.GetDecimal(Int32 i)
   at lambda_method356(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BackOffice.Application.Features.Categories.Queries.GetCategoriesList.GetCategoriesListQueryHandler.Handle(GetCategoriesListQuery request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Application\Features\Categories\Queries\GetCategoriesList\GetCategoriesListQueryHandler.cs:line 35
   at BackOffice.Api.Controllers.CategoriesController.GetCategoriesList(String typeEquipement) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Controllers\CategoriesController.cs:line 38
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at BackOffice.Api.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Middleware\ErrorHandlingMiddleware.cs:line 21
2026-01-16 01:54:51.506 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[ContactEmail], [d].[ContactNom], [d].[DateCreation], [d].[DateModification], [d].[Description], [d].[Equipement], [d].[EstHomologable], [d].[Fabricant], [d].[IdCategorie], [d].[IdDossier], [d].[IdMotifRejet], [d].[IdProposition], [d].[Marque], [d].[Modele], [d].[NumeroDemande], [d].[PrixUnitaire], [d].[QuantiteEquipements], [d].[Remise], [d].[Type], [d].[UtilisateurCreation], [d].[UtilisateurModification]
FROM [demandes] AS [d]
WHERE [d].[Id] = @__p_0
2026-01-16 01:54:51.583 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__request_CategorieId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Code], [c].[DateCreation], [c].[DateModification], [c].[FormuleHomologation], [c].[FraisControle], [c].[FraisEtude], [c].[FraisHomologation], [c].[FraisHomologationParLot], [c].[FraisHomologationQuantiteParLot], [c].[Libelle], [c].[QuantiteReference], [c].[Remarques], [c].[TypeClient], [c].[TypeEquipement], [c].[UtilisateurCreation], [c].[UtilisateurModification]
FROM [categoriesEquipements] AS [c]
WHERE [c].[Id] = @__request_CategorieId_0
2026-01-16 01:54:51.591 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'BackOffice.Infrastructure.Persistence.BackOfficeDbContext'.
System.InvalidCastException: Unable to cast object of type 'System.Byte' to type 'System.Decimal'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Decimal()
   at Microsoft.Data.SqlClient.SqlDataReader.GetDecimal(Int32 i)
   at lambda_method497(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Unable to cast object of type 'System.Byte' to type 'System.Decimal'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Decimal()
   at Microsoft.Data.SqlClient.SqlDataReader.GetDecimal(Int32 i)
   at lambda_method497(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2026-01-16 01:54:51.735 +01:00 [ERR] Une exception non gérée a été interceptée.
System.InvalidCastException: Unable to cast object of type 'System.Byte' to type 'System.Decimal'.
   at Microsoft.Data.SqlClient.SqlBuffer.get_Decimal()
   at Microsoft.Data.SqlClient.SqlDataReader.GetDecimal(Int32 i)
   at lambda_method497(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BackOffice.Application.Features.Demandes.Commands.AddCategorieToDemande.AddCategorieToDemandeCommandHandler.Handle(AddCategorieToDemandeCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Application\Features\Demandes\Commands\AddCategorieToDemande\AddCategorieToDemandeCommandHandler.cs:line 45
   at BackOffice.Api.Controllers.DemandesController.AddCategorieToDemande(Guid demandeId, AddCategorieToDemandeCommand command) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Controllers\DemandesController.cs:line 44
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at BackOffice.Api.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api\Middleware\ErrorHandlingMiddleware.cs:line 21
2026-01-16 02:53:51.113 +01:00 [INF] Executed DbCommand (370ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [ArpceHomologation_BD_Commun];
2026-01-16 02:53:51.251 +01:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [ArpceHomologation_BD_Commun] SET READ_COMMITTED_SNAPSHOT ON;
END;
2026-01-16 02:53:51.276 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2026-01-16 02:53:51.301 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2026-01-16 02:53:51.407 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2026-01-16 02:53:51.416 +01:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2026-01-16 02:53:51.417 +01:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2026-01-16 02:53:51.428 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2026-01-16 02:53:51.685 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminAccess] (
    [Id] uniqueidentifier NOT NULL,
    [Application] nvarchar(120) NOT NULL,
    [Groupe] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Page] nvarchar(120) NULL,
    [Type] nvarchar(120) NOT NULL,
    [Inactif] tinyint NULL,
    [Ajouter] tinyint NULL,
    [Valider] tinyint NULL,
    [Supprimer] tinyint NULL,
    [Imprimer] tinyint NULL,
    [Code] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_adminAccess] PRIMARY KEY ([Id])
);
2026-01-16 02:53:51.688 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminConnexions] (
    [Id] uniqueidentifier NOT NULL,
    [Utilisateur] nvarchar(60) NOT NULL,
    [DateConnexion] bigint NOT NULL,
    [Ip] nvarchar(60) NULL,
    CONSTRAINT [PK_adminConnexions] PRIMARY KEY ([Id])
);
2026-01-16 02:53:51.691 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminEvenementsTypes] (
    [Id] uniqueidentifier NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Code] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_adminEvenementsTypes] PRIMARY KEY ([Id])
);
2026-01-16 02:53:51.696 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AdminOptions] (
    [Id] uniqueidentifier NOT NULL,
    [JournalActivation] tinyint NULL,
    [EventConnexion] tinyint NULL,
    [EventOuverturePage] tinyint NULL,
    [EventChangementMotPasse] tinyint NULL,
    [EventModificationDonnees] tinyint NULL,
    [EventSuppressionDonnees] tinyint NULL,
    [EventImpression] tinyint NULL,
    [EventValidation] tinyint NULL,
    [JournalLimitation] tinyint NULL,
    [JournalTypeLimitation] tinyint NULL,
    [JournalDureeLimitation] int NULL,
    [JournalTypeDureeLimitation] tinyint NULL,
    [JournalTailleLimitation] int NULL,
    [LDAPAuthentificationActivation] tinyint NULL,
    [LDAPAuthentificationNomDomaine] nvarchar(60) NULL,
    [LDAPCreationAutoActivation] tinyint NULL,
    [LDAPCreationAutoNomServeur] nvarchar(60) NULL,
    [LDAPCreationAutoCompte] nvarchar(60) NULL,
    [LDAPCreationAutoPassword] nvarchar(60) NULL,
    [ReplicationActivation] tinyint NULL,
    [ReplicationNomServeur] nvarchar(60) NULL,
    [ReplicationCompte] nvarchar(60) NULL,
    [ReplicationPassword] nvarchar(60) NULL,
    CONSTRAINT [PK_AdminOptions] PRIMARY KEY ([Id])
);
2026-01-16 02:53:53.142 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminProfils] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_adminProfils] PRIMARY KEY ([Id])
);
2026-01-16 02:53:53.145 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminReporting] (
    [Id] uniqueidentifier NOT NULL,
    [Application] nvarchar(120) NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Inactif] tinyint NULL,
    CONSTRAINT [PK_adminReporting] PRIMARY KEY ([Id])
);
2026-01-16 02:53:53.147 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminUtilisateurTypes] (
    [Id] uniqueidentifier NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    CONSTRAINT [PK_adminUtilisateurTypes] PRIMARY KEY ([Id])
);
2026-01-16 02:53:53.148 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [categoriesEquipements] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [TypeEquipement] nvarchar(50) NOT NULL,
    [TypeClient] nvarchar(50) NOT NULL,
    [FormuleHomologation] nvarchar(255) NULL,
    [QuantiteReference] int NULL,
    [FraisEtude] money NULL,
    [FraisHomologation] money NULL,
    [FraisHomologationParLot] tinyint NULL,
    [FraisHomologationQuantiteParLot] int NULL,
    [FraisControle] money NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_categoriesEquipements] PRIMARY KEY ([Id])
);
2026-01-16 02:53:56.856 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [clients] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(30) NOT NULL,
    [RaisonSociale] nvarchar(120) NOT NULL,
    [RegistreCommerce] nvarchar(60) NULL,
    [MotPasse] nvarchar(255) NULL,
    [ChangementMotPasse] tinyint NULL,
    [Desactive] tinyint NULL,
    [ContactNom] nvarchar(60) NULL,
    [ContactTelephone] nvarchar(30) NULL,
    [ContactFonction] nvarchar(60) NULL,
    [Email] nvarchar(120) NULL,
    [Adresse] nvarchar(255) NULL,
    [Bp] nvarchar(60) NULL,
    [Ville] nvarchar(100) NULL,
    [Pays] nvarchar(100) NULL,
    [Remarques] nvarchar(512) NULL,
    [TypeClient] nvarchar(20) NOT NULL DEFAULT N'Entreprise',
    [NiveauValidation] int NOT NULL DEFAULT 0,
    [IsVerified] bit NOT NULL DEFAULT CAST(0 AS bit),
    [VerificationCode] nvarchar(6) NULL,
    [VerificationTokenExpiry] bigint NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_clients] PRIMARY KEY ([Id])
);
2026-01-16 02:53:56.859 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [modesReglements] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [MobileBanking] tinyint NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_modesReglements] PRIMARY KEY ([Id])
);
2026-01-16 02:54:00.306 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [motifsRejets] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_motifsRejets] PRIMARY KEY ([Id])
);
2026-01-16 02:54:00.309 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(200) NOT NULL,
    [Message] nvarchar(1000) NOT NULL,
    [Type] nvarchar(50) NOT NULL,
    [TargetUrl] nvarchar(500) NULL,
    [EntityId] nvarchar(100) NULL,
    [UserId] uniqueidentifier NULL,
    [ProfilCode] nvarchar(100) NULL,
    [IsBroadcast] bit NOT NULL,
    [IsRead] bit NOT NULL,
    [DateEnvoi] bigint NOT NULL,
    [UtilisateurCreation] nvarchar(max) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(max) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_notifications] PRIMARY KEY ([Id])
);
2026-01-16 02:54:00.311 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [propositions] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(12) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_propositions] PRIMARY KEY ([Id])
);
2026-01-16 02:54:00.313 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [statuts] (
    [Id] uniqueidentifier NOT NULL,
    [Code] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    CONSTRAINT [PK_statuts] PRIMARY KEY ([Id])
);
2026-01-16 02:54:03.691 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminProfilsAcces] (
    [IdProfil] uniqueidentifier NOT NULL,
    [IdAccess] uniqueidentifier NOT NULL,
    [Ajouter] tinyint NULL,
    [Valider] tinyint NULL,
    [Supprimer] tinyint NULL,
    [Imprimer] tinyint NULL,
    [AdminProfilsId] uniqueidentifier NULL,
    CONSTRAINT [PK_adminProfilsAcces] PRIMARY KEY ([IdProfil], [IdAccess]),
    CONSTRAINT [FK_adminProfilsAcces_adminAccess_IdAccess] FOREIGN KEY ([IdAccess]) REFERENCES [adminAccess] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_adminProfilsAcces_adminProfils_AdminProfilsId] FOREIGN KEY ([AdminProfilsId]) REFERENCES [adminProfils] ([Id]),
    CONSTRAINT [FK_adminProfilsAcces_adminProfils_IdProfil] FOREIGN KEY ([IdProfil]) REFERENCES [adminProfils] ([Id]) ON DELETE CASCADE
);
2026-01-16 02:54:03.693 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminProfilsUtilisateursLDAP] (
    [Utilisateur] nvarchar(120) NOT NULL,
    [IdProfil] uniqueidentifier NOT NULL,
    [AdminProfilsId] uniqueidentifier NULL,
    CONSTRAINT [PK_adminProfilsUtilisateursLDAP] PRIMARY KEY ([Utilisateur], [IdProfil]),
    CONSTRAINT [FK_adminProfilsUtilisateursLDAP_adminProfils_AdminProfilsId] FOREIGN KEY ([AdminProfilsId]) REFERENCES [adminProfils] ([Id]),
    CONSTRAINT [FK_adminProfilsUtilisateursLDAP_adminProfils_IdProfil] FOREIGN KEY ([IdProfil]) REFERENCES [adminProfils] ([Id]) ON DELETE CASCADE
);
2026-01-16 02:54:03.698 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AdminUtilisateurs] (
    [Id] uniqueidentifier NOT NULL,
    [IdProfil] uniqueidentifier NULL,
    [IdUtilisateurType] uniqueidentifier NOT NULL,
    [Compte] nvarchar(100) NOT NULL,
    [Nom] nvarchar(100) NOT NULL,
    [Prenoms] nvarchar(150) NULL,
    [MotPasse] nvarchar(255) NULL,
    [ChangementMotPasse] bit NOT NULL,
    [Desactive] bit NOT NULL,
    [Remarques] nvarchar(512) NULL,
    [DerniereConnexion] bigint NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    [AdminProfilsId] uniqueidentifier NULL,
    CONSTRAINT [PK_AdminUtilisateurs] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AdminUtilisateurs_adminProfils_AdminProfilsId] FOREIGN KEY ([AdminProfilsId]) REFERENCES [adminProfils] ([Id]),
    CONSTRAINT [FK_AdminUtilisateurs_adminProfils_IdProfil] FOREIGN KEY ([IdProfil]) REFERENCES [adminProfils] ([Id]) ON DELETE SET NULL,
    CONSTRAINT [FK_AdminUtilisateurs_adminUtilisateurTypes_IdUtilisateurType] FOREIGN KEY ([IdUtilisateurType]) REFERENCES [adminUtilisateurTypes] ([Id]) ON DELETE NO ACTION
);
2026-01-16 02:54:07.252 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [dossiers] (
    [Id] uniqueidentifier NOT NULL,
    [IdClient] uniqueidentifier NOT NULL,
    [IdStatut] uniqueidentifier NOT NULL,
    [IdModeReglement] uniqueidentifier NULL,
    [DateOuverture] bigint NOT NULL,
    [Numero] nvarchar(30) NOT NULL,
    [Libelle] nvarchar(120) NOT NULL,
    [IdAgentInstructeur] uniqueidentifier NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_dossiers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_dossiers_AdminUtilisateurs_IdAgentInstructeur] FOREIGN KEY ([IdAgentInstructeur]) REFERENCES [AdminUtilisateurs] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_dossiers_clients_IdClient] FOREIGN KEY ([IdClient]) REFERENCES [clients] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_dossiers_modesReglements_IdModeReglement] FOREIGN KEY ([IdModeReglement]) REFERENCES [modesReglements] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_dossiers_statuts_IdStatut] FOREIGN KEY ([IdStatut]) REFERENCES [statuts] ([Id]) ON DELETE NO ACTION
);
2026-01-16 02:54:07.255 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [adminJournal] (
    [Id] uniqueidentifier NOT NULL,
    [IdEvenementType] uniqueidentifier NOT NULL,
    [Application] nvarchar(120) NOT NULL,
    [AdresseIP] nvarchar(120) NOT NULL,
    [Utilisateur] nvarchar(120) NOT NULL,
    [DateEvenement] bigint NOT NULL,
    [Page] nvarchar(120) NOT NULL,
    [Libelle] nvarchar(255) NULL,
    [IdDossier] uniqueidentifier NULL,
    [DossierId] uniqueidentifier NULL,
    CONSTRAINT [PK_adminJournal] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_adminJournal_adminEvenementsTypes_IdEvenementType] FOREIGN KEY ([IdEvenementType]) REFERENCES [adminEvenementsTypes] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_adminJournal_dossiers_DossierId] FOREIGN KEY ([DossierId]) REFERENCES [dossiers] ([Id])
);
2026-01-16 02:54:09.547 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [commentaires] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [DateCommentaire] bigint NOT NULL,
    [commentaire] nvarchar(512) NULL,
    [NomInstructeur] nvarchar(60) NULL,
    [Proposition] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_commentaires] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_commentaires_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE
);
2026-01-16 02:54:09.553 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [demandes] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [IdCategorie] uniqueidentifier NULL,
    [IdMotifRejet] uniqueidentifier NULL,
    [IdProposition] uniqueidentifier NULL,
    [NumeroDemande] nvarchar(12) NULL,
    [Equipement] nvarchar(120) NULL,
    [Modele] nvarchar(120) NULL,
    [Marque] nvarchar(120) NULL,
    [Fabricant] nvarchar(120) NULL,
    [Type] nvarchar(120) NULL,
    [Description] nvarchar(512) NULL,
    [QuantiteEquipements] int NULL,
    [ContactNom] nvarchar(60) NULL,
    [ContactEmail] nvarchar(60) NULL,
    [PrixUnitaire] money NULL,
    [Remise] decimal(5,2) NULL,
    [EstHomologable] bit NOT NULL DEFAULT CAST(1 AS bit),
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_demandes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_demandes_categoriesEquipements_IdCategorie] FOREIGN KEY ([IdCategorie]) REFERENCES [categoriesEquipements] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_demandes_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_demandes_motifsRejets_IdMotifRejet] FOREIGN KEY ([IdMotifRejet]) REFERENCES [motifsRejets] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_demandes_propositions_IdProposition] FOREIGN KEY ([IdProposition]) REFERENCES [propositions] ([Id]) ON DELETE NO ACTION
);
2026-01-16 02:54:11.703 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [documentsDossiers] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [Nom] nvarchar(120) NULL,
    [Type] tinyint NULL,
    [Donnees] varbinary(max) NULL,
    [Extension] nvarchar(12) NOT NULL,
    [FilePath] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_documentsDossiers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_documentsDossiers_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE
);
2026-01-16 02:54:11.707 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [attestations] (
    [Id] uniqueidentifier NOT NULL,
    [IdDemande] uniqueidentifier NOT NULL,
    [DateDelivrance] bigint NOT NULL,
    [DateExpiration] bigint NOT NULL,
    [Donnees] varbinary(max) NOT NULL,
    [Extension] nvarchar(12) NOT NULL,
    [NumeroSequentiel] int NOT NULL DEFAULT 0,
    [UtilisateurCreation] nvarchar(max) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(max) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_attestations] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_attestations_demandes_IdDemande] FOREIGN KEY ([IdDemande]) REFERENCES [demandes] ([Id]) ON DELETE CASCADE
);
2026-01-16 02:54:14.460 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [devis] (
    [Id] uniqueidentifier NOT NULL,
    [IdDossier] uniqueidentifier NOT NULL,
    [IdDemande] uniqueidentifier NULL,
    [Date] bigint NOT NULL,
    [MontantEtude] money NOT NULL,
    [MontantHomologation] money NULL,
    [MontantControle] money NULL,
    [PaiementOk] tinyint NULL,
    [PaiementMobileId] nvarchar(60) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_devis] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_devis_demandes_IdDemande] FOREIGN KEY ([IdDemande]) REFERENCES [demandes] ([Id]),
    CONSTRAINT [FK_devis_dossiers_IdDossier] FOREIGN KEY ([IdDossier]) REFERENCES [dossiers] ([Id]) ON DELETE CASCADE
);
2026-01-16 02:54:14.464 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [documentsDemandes] (
    [Id] uniqueidentifier NOT NULL,
    [IdDemande] uniqueidentifier NOT NULL,
    [Nom] nvarchar(120) NULL,
    [Donnees] varbinary(max) NULL,
    [Extension] nvarchar(12) NOT NULL,
    [FilePath] nvarchar(512) NULL,
    [UtilisateurCreation] nvarchar(60) NULL,
    [DateCreation] bigint NULL,
    [UtilisateurModification] nvarchar(60) NULL,
    [DateModification] bigint NULL,
    CONSTRAINT [PK_documentsDemandes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_documentsDemandes_demandes_IdDemande] FOREIGN KEY ([IdDemande]) REFERENCES [demandes] ([Id]) ON DELETE CASCADE
);
2026-01-16 02:54:17.025 +01:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminEvenementsTypes]'))
    SET IDENTITY_INSERT [adminEvenementsTypes] ON;
INSERT INTO [adminEvenementsTypes] ([Id], [Code], [Libelle])
VALUES ('22dd1750-493f-4778-977a-9e32950d39aa', N'COMMUNICATION', N'Envoi de communication'),
('24b5d07d-7847-4434-bb38-4061c80a83f5', N'VALIDATION', N'Validation de processus'),
('2ea99492-748e-4726-8ef6-b74c42d580ac', N'SECURITE', N'Action de sécurité'),
('4a0e9be1-df57-4c2e-a76e-aeb47783fc4e', N'SUPPRESSION', N'Suppression de données'),
('823d8193-41d1-4046-86ca-c7c1623735ae', N'QUALIFICATION', N'Qualification de données'),
('938c7cba-675f-41e1-8b17-810ae57d945b', N'MODIFICATION', N'Connexion utilisateur'),
('b91c6126-b966-4e2d-9a01-52429c0dc171', N'ATTRIBUTION', N'Attribution de droits/profils'),
('d2b6eb3d-528b-400c-b6f7-4151cc8a9c54', N'CONNEXION', N'Modification'),
('fc3c239b-ed73-4006-9b7e-726fd29a3159', N'CREATION', N'Création de données'),
('fea2e948-c9e0-4c47-9dbd-ed46e90fa020', N'MODIFICATION', N'Modification de données');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminEvenementsTypes]'))
    SET IDENTITY_INSERT [adminEvenementsTypes] OFF;
2026-01-16 02:54:17.039 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminUtilisateurTypes]'))
    SET IDENTITY_INSERT [adminUtilisateurTypes] ON;
INSERT INTO [adminUtilisateurTypes] ([Id], [Libelle])
VALUES ('0b1c7de2-12a2-41cc-990b-06f98d69091e', N'Auditeur'),
('7e5b7d94-4f5d-4eff-9983-c8f846d3cee6', N'Administrateur'),
('b8bdee6d-8eb0-4604-9247-5df7cf365f65', N'Utilisateur Standard');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Libelle') AND [object_id] = OBJECT_ID(N'[adminUtilisateurTypes]'))
    SET IDENTITY_INSERT [adminUtilisateurTypes] OFF;
2026-01-16 02:54:19.796 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'DateCreation', N'DateModification', N'Libelle', N'MobileBanking', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[modesReglements]'))
    SET IDENTITY_INSERT [modesReglements] ON;
INSERT INTO [modesReglements] ([Id], [Code], [DateCreation], [DateModification], [Libelle], [MobileBanking], [Remarques], [UtilisateurCreation], [UtilisateurModification])
VALUES ('1a0ea036-99eb-483a-a174-d12d78404789', N'Cheque', NULL, NULL, N'Chèque', CAST(0 AS tinyint), NULL, NULL, NULL),
('34a379c6-33c0-4db9-87ae-c3e443ffc7c8', N'Especes', NULL, NULL, N'Espèces', CAST(0 AS tinyint), NULL, NULL, NULL),
('4df4a9bf-37c8-43d0-b77e-6e0648da441b', N'Virement', NULL, NULL, N'Virement bancaire', CAST(0 AS tinyint), NULL, NULL, NULL),
('fb510894-8ada-4416-9bff-2638a1a85ca5', N'MobileBanking', NULL, NULL, N'Paiement mobile', CAST(1 AS tinyint), NULL, NULL, NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'DateCreation', N'DateModification', N'Libelle', N'MobileBanking', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[modesReglements]'))
    SET IDENTITY_INSERT [modesReglements] OFF;
2026-01-16 02:54:19.815 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[statuts]'))
    SET IDENTITY_INSERT [statuts] ON;
INSERT INTO [statuts] ([Id], [Code], [Libelle])
VALUES ('0c47f66c-3ae3-4dbf-af5b-1b7eb3f2a213', N'PaiementRejete', N'Paiement non accepté'),
('0d4f6e52-ad8e-4b67-9a11-985b66dca204', N'ApprobationInstruction', N'Envoyé pour approbation'),
('0e9a8bb4-7989-4eb8-9f21-4f9b7ffca216', N'DossierSignature', N'Attestation en signature'),
('11223344-5566-7788-99aa-bbccddeeff00', N'PaiementBanque', N'Dossier payé par la banque'),
('1a173ab7-6db7-4b9f-906e-a85352a4a212', N'DevisPaiement', N'En attente de paiement'),
('33b7bd1d-5901-4afe-be70-d4c10e3fa215', N'DossierPayer', N'Paiement effectué'),
('3b9ed3a1-1e24-4d0c-8f13-7c55c9baa203', N'Instruction', N'En cours d''instruction'),
('5a6b7c8d-9e0f-1a2b-3c4d-5e6f70809000', N'EnPaiement', N'Dossier en attente de paiement'),
('84c6d32b-1f44-4fbd-8c91-12e3b5e0a205', N'InstructionApprouve', N'Instruction Approuvée'),
('8c2bc784-06a3-4d73-a9f4-5f6d94a7a210', N'DevisValide', N'Devis validé par client'),
('9f1c2f69-5d8e-4ec8-a6a1-0aa1e1c5a201', N'NouveauDossier', N'Nouvelle demande'),
('a7c55954-7b1c-4f43-9cc4-1f2af3cca202', N'RefusDossier', N'Refus de la demande'),
('aa11bb22-cc33-dd44-ee55-ff6600112233', N'Certification', N'Certification initiée'),
('ae906d70-a1c2-4b2a-8db7-b22c6d4ca207', N'DevisValideSC', N'Devis validé par Chef Service'),
('ccf4f5b7-8be7-4f01-9c09-fa5522d6a209', N'DevisEmit', N'Devis émis'),
('cd3c7e21-6909-4a29-9f0e-90e9ac2da211', N'DevisRefuser', N'Devis refusé par client'),
('d62e63cb-4c2f-4e24-b5a2-8fae11e0a206', N'DevisCreer', N'Devis créé'),
('df4bb5aa-17d5-4c04-8545-48f59c59a214', N'PaiementExpirer', N'Paiement expiré'),
('ed13c54b-5e63-4a0f-a0a7-332a7c27a217', N'DossierSigner', N'Attestation signée'),
('f1a2b3c4-d5e6-4f78-9012-34567890a218', N'Echantillon', N'En attente échantillon'),
('fc01b3e8-82d8-4e55-953f-0fc9edb2a208', N'DevisValideTr', N'Devis validé par Trésorerie');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'Code', N'Libelle') AND [object_id] = OBJECT_ID(N'[statuts]'))
    SET IDENTITY_INSERT [statuts] OFF;
2026-01-16 02:54:21.345 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AdminProfilsId', N'ChangementMotPasse', N'Compte', N'DateCreation', N'DateModification', N'DerniereConnexion', N'Desactive', N'IdProfil', N'IdUtilisateurType', N'MotPasse', N'Nom', N'Prenoms', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[AdminUtilisateurs]'))
    SET IDENTITY_INSERT [AdminUtilisateurs] ON;
INSERT INTO [AdminUtilisateurs] ([Id], [AdminProfilsId], [ChangementMotPasse], [Compte], [DateCreation], [DateModification], [DerniereConnexion], [Desactive], [IdProfil], [IdUtilisateurType], [MotPasse], [Nom], [Prenoms], [Remarques], [UtilisateurCreation], [UtilisateurModification])
VALUES ('88888888-8888-8888-8888-888888888888', NULL, CAST(1 AS bit), N'admin', CAST(1768528372604 AS bigint), NULL, NULL, CAST(0 AS bit), NULL, '7e5b7d94-4f5d-4eff-9983-c8f846d3cee6', N'$2a$11$Iw4fIyfoV4R94B.flokOuOfHuaO4R8HumcogYp4S5Utk/PK.D2B6W', N'root', N'ARPCE', NULL, N'SYSTEM_SEED', NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'AdminProfilsId', N'ChangementMotPasse', N'Compte', N'DateCreation', N'DateModification', N'DerniereConnexion', N'Desactive', N'IdProfil', N'IdUtilisateurType', N'MotPasse', N'Nom', N'Prenoms', N'Remarques', N'UtilisateurCreation', N'UtilisateurModification') AND [object_id] = OBJECT_ID(N'[AdminUtilisateurs]'))
    SET IDENTITY_INSERT [AdminUtilisateurs] OFF;
2026-01-16 02:54:22.537 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminJournal_DossierId] ON [adminJournal] ([DossierId]);
2026-01-16 02:54:22.539 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminJournal_IdEvenementType] ON [adminJournal] ([IdEvenementType]);
2026-01-16 02:54:22.540 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminProfilsAcces_AdminProfilsId] ON [adminProfilsAcces] ([AdminProfilsId]);
2026-01-16 02:54:24.060 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminProfilsAcces_IdAccess] ON [adminProfilsAcces] ([IdAccess]);
2026-01-16 02:54:24.063 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminProfilsUtilisateursLDAP_AdminProfilsId] ON [adminProfilsUtilisateursLDAP] ([AdminProfilsId]);
2026-01-16 02:54:24.065 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_adminProfilsUtilisateursLDAP_IdProfil] ON [adminProfilsUtilisateursLDAP] ([IdProfil]);
2026-01-16 02:54:24.077 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AdminUtilisateurs_AdminProfilsId] ON [AdminUtilisateurs] ([AdminProfilsId]);
2026-01-16 02:54:24.082 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AdminUtilisateurs_Compte] ON [AdminUtilisateurs] ([Compte]);
2026-01-16 02:54:24.087 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AdminUtilisateurs_IdProfil] ON [AdminUtilisateurs] ([IdProfil]);
2026-01-16 02:54:24.091 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AdminUtilisateurs_IdUtilisateurType] ON [AdminUtilisateurs] ([IdUtilisateurType]);
2026-01-16 02:54:24.095 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_AdminUtilisateurs_Nom] ON [AdminUtilisateurs] ([Nom]);
2026-01-16 02:54:24.098 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_attestations_IdDemande] ON [attestations] ([IdDemande]);
2026-01-16 02:54:24.100 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_attestations_NumeroSequentiel] ON [attestations] ([NumeroSequentiel]);
2026-01-16 02:54:24.102 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_commentaires_IdDossier] ON [commentaires] ([IdDossier]);
2026-01-16 02:54:24.991 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdCategorie] ON [demandes] ([IdCategorie]);
2026-01-16 02:54:24.992 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdDossier] ON [demandes] ([IdDossier]);
2026-01-16 02:54:24.994 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdMotifRejet] ON [demandes] ([IdMotifRejet]);
2026-01-16 02:54:24.996 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_demandes_IdProposition] ON [demandes] ([IdProposition]);
2026-01-16 02:54:24.998 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_devis_IdDemande] ON [devis] ([IdDemande]);
2026-01-16 02:54:25.000 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_devis_IdDossier] ON [devis] ([IdDossier]);
2026-01-16 02:54:25.002 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_documentsDemandes_IdDemande] ON [documentsDemandes] ([IdDemande]);
2026-01-16 02:54:25.003 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_documentsDossiers_IdDossier] ON [documentsDossiers] ([IdDossier]);
2026-01-16 02:54:25.004 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdAgentInstructeur] ON [dossiers] ([IdAgentInstructeur]);
2026-01-16 02:54:25.006 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdClient] ON [dossiers] ([IdClient]);
2026-01-16 02:54:25.007 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdModeReglement] ON [dossiers] ([IdModeReglement]);
2026-01-16 02:54:25.009 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_dossiers_IdStatut] ON [dossiers] ([IdStatut]);
2026-01-16 02:54:26.372 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_notifications_DateEnvoi] ON [notifications] ([DateEnvoi]);
2026-01-16 02:54:26.374 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_notifications_IsBroadcast] ON [notifications] ([IsBroadcast]);
2026-01-16 02:54:26.375 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_notifications_ProfilCode] ON [notifications] ([ProfilCode]);
2026-01-16 02:54:26.377 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_notifications_UserId] ON [notifications] ([UserId]);
2026-01-16 02:54:26.381 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20260116015256_BD_Commun', N'9.0.11');
2026-01-16 02:54:26.386 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2026-01-16 02:55:02.834 +01:00 [INF] Now listening on: https://localhost:7238
2026-01-16 02:55:02.880 +01:00 [INF] Now listening on: http://localhost:5126
2026-01-16 02:55:03.001 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-16 02:55:03.004 +01:00 [INF] Hosting environment: Development
2026-01-16 02:55:03.007 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Api
2026-01-16 02:55:41.036 +01:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2026-01-16 02:55:44.372 +01:00 [INF] Executed DbCommand (88ms) [Parameters=[@__request_Compte_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AdminProfilsId], [a].[ChangementMotPasse], [a].[Compte], [a].[DateCreation], [a].[DateModification], [a].[DerniereConnexion], [a].[Desactive], [a].[IdProfil], [a].[IdUtilisateurType], [a].[MotPasse], [a].[Nom], [a].[Prenoms], [a].[Remarques], [a].[UtilisateurCreation], [a].[UtilisateurModification], [a0].[Id], [a0].[Code], [a0].[DateCreation], [a0].[DateModification], [a0].[Libelle], [a0].[Remarques], [a0].[UtilisateurCreation], [a0].[UtilisateurModification]
FROM [AdminUtilisateurs] AS [a]
LEFT JOIN [adminProfils] AS [a0] ON [a].[IdProfil] = [a0].[Id]
WHERE [a].[Compte] = @__request_Compte_0
2026-01-16 02:55:45.201 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@p1='?' (DbType = Guid), @p0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AdminUtilisateurs] SET [DerniereConnexion] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2026-01-16 02:57:57.587 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 12), @p2='?' (DbType = Int64), @p3='?' (DbType = Int64), @p4='?' (Size = 255), @p5='?' (DbType = Currency), @p6='?' (DbType = Currency), @p7='?' (DbType = Currency), @p8='?' (DbType = Byte), @p9='?' (DbType = Int32), @p10='?' (Size = 120), @p11='?' (DbType = Int32), @p12='?' (Size = 512), @p13='?' (Size = 50), @p14='?' (Size = 50), @p15='?' (Size = 60), @p16='?' (Size = 60)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [categoriesEquipements] ([Id], [Code], [DateCreation], [DateModification], [FormuleHomologation], [FraisControle], [FraisEtude], [FraisHomologation], [FraisHomologationParLot], [FraisHomologationQuantiteParLot], [Libelle], [QuantiteReference], [Remarques], [TypeClient], [TypeEquipement], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2026-01-16 02:57:57.614 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__eventTypeCode_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Code], [a].[Libelle]
FROM [adminEvenementsTypes] AS [a]
WHERE [a].[Code] = @__eventTypeCode_0
2026-01-16 02:57:57.652 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AdminProfilsId], [a].[ChangementMotPasse], [a].[Compte], [a].[DateCreation], [a].[DateModification], [a].[DerniereConnexion], [a].[Desactive], [a].[IdProfil], [a].[IdUtilisateurType], [a].[MotPasse], [a].[Nom], [a].[Prenoms], [a].[Remarques], [a].[UtilisateurCreation], [a].[UtilisateurModification]
FROM [AdminUtilisateurs] AS [a]
WHERE [a].[Id] = @__p_0
2026-01-16 02:57:57.716 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 120), @p2='?' (Size = 120), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (Size = 255), @p8='?' (Size = 120), @p9='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [adminJournal] ([Id], [AdresseIP], [Application], [DateEvenement], [DossierId], [IdDossier], [IdEvenementType], [Libelle], [Page], [Utilisateur])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2026-01-16 03:10:59.260 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[@__request_DossierId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[DateCreation], [s0].[DateModification], [s0].[DateOuverture], [s0].[IdAgentInstructeur], [s0].[IdClient], [s0].[IdModeReglement], [s0].[IdStatut], [s0].[Libelle], [s0].[Numero], [s0].[UtilisateurCreation], [s0].[UtilisateurModification], [s0].[Id0], [s0].[Code], [s0].[Libelle0], [s1].[Id], [s1].[ContactEmail], [s1].[ContactNom], [s1].[DateCreation], [s1].[DateModification], [s1].[Description], [s1].[Equipement], [s1].[EstHomologable], [s1].[Fabricant], [s1].[IdCategorie], [s1].[IdDossier], [s1].[IdMotifRejet], [s1].[IdProposition], [s1].[Marque], [s1].[Modele], [s1].[NumeroDemande], [s1].[PrixUnitaire], [s1].[QuantiteEquipements], [s1].[Remise], [s1].[Type], [s1].[UtilisateurCreation], [s1].[UtilisateurModification], [s1].[Id0], [s1].[Code], [s1].[DateCreation0], [s1].[DateModification0], [s1].[FormuleHomologation], [s1].[FraisControle], [s1].[FraisEtude], [s1].[FraisHomologation], [s1].[FraisHomologationParLot], [s1].[FraisHomologationQuantiteParLot], [s1].[Libelle], [s1].[QuantiteReference], [s1].[Remarques], [s1].[TypeClient], [s1].[TypeEquipement], [s1].[UtilisateurCreation0], [s1].[UtilisateurModification0]
FROM (
    SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdAgentInstructeur], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id] AS [Id0], [s].[Code], [s].[Libelle] AS [Libelle0]
    FROM [dossiers] AS [d]
    INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
    WHERE [d].[Id] = @__request_DossierId_0
) AS [s0]
LEFT JOIN (
    SELECT [d0].[Id], [d0].[ContactEmail], [d0].[ContactNom], [d0].[DateCreation], [d0].[DateModification], [d0].[Description], [d0].[Equipement], [d0].[EstHomologable], [d0].[Fabricant], [d0].[IdCategorie], [d0].[IdDossier], [d0].[IdMotifRejet], [d0].[IdProposition], [d0].[Marque], [d0].[Modele], [d0].[NumeroDemande], [d0].[PrixUnitaire], [d0].[QuantiteEquipements], [d0].[Remise], [d0].[Type], [d0].[UtilisateurCreation], [d0].[UtilisateurModification], [c].[Id] AS [Id0], [c].[Code], [c].[DateCreation] AS [DateCreation0], [c].[DateModification] AS [DateModification0], [c].[FormuleHomologation], [c].[FraisControle], [c].[FraisEtude], [c].[FraisHomologation], [c].[FraisHomologationParLot], [c].[FraisHomologationQuantiteParLot], [c].[Libelle], [c].[QuantiteReference], [c].[Remarques], [c].[TypeClient], [c].[TypeEquipement], [c].[UtilisateurCreation] AS [UtilisateurCreation0], [c].[UtilisateurModification] AS [UtilisateurModification0]
    FROM [demandes] AS [d0]
    LEFT JOIN [categoriesEquipements] AS [c] ON [d0].[IdCategorie] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[IdDossier]
ORDER BY [s0].[Id], [s0].[Id0], [s1].[Id]
2026-01-16 03:10:59.496 +01:00 [ERR] Échec de la validation de l'instruction et de la création du devis pour le dossier "8873f2cf-5cae-4779-bfbf-9e3369736f2e"
System.InvalidOperationException: L'opération de validation n'est pas autorisée. Le dossier est actuellement au statut 'Nouvelle demande'.
   at BackOffice.Application.Features.Dossiers.Commands.ValidateInstruction.ValidateInstructionCommandHandler.Handle(ValidateInstructionCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-backOffice\Arpce.Homologation.BackOffice\BackOffice.Application\Features\Dossiers\Commands\ValidateInstruction\ValidateInstructionCommandHandler.cs:line 62
2026-01-16 03:21:35.378 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@__request_DossierId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[DateCreation], [s0].[DateModification], [s0].[DateOuverture], [s0].[IdAgentInstructeur], [s0].[IdClient], [s0].[IdModeReglement], [s0].[IdStatut], [s0].[Libelle], [s0].[Numero], [s0].[UtilisateurCreation], [s0].[UtilisateurModification], [s0].[Id0], [s0].[Code], [s0].[Libelle0], [s1].[Id], [s1].[ContactEmail], [s1].[ContactNom], [s1].[DateCreation], [s1].[DateModification], [s1].[Description], [s1].[Equipement], [s1].[EstHomologable], [s1].[Fabricant], [s1].[IdCategorie], [s1].[IdDossier], [s1].[IdMotifRejet], [s1].[IdProposition], [s1].[Marque], [s1].[Modele], [s1].[NumeroDemande], [s1].[PrixUnitaire], [s1].[QuantiteEquipements], [s1].[Remise], [s1].[Type], [s1].[UtilisateurCreation], [s1].[UtilisateurModification], [s1].[Id0], [s1].[Code], [s1].[DateCreation0], [s1].[DateModification0], [s1].[FormuleHomologation], [s1].[FraisControle], [s1].[FraisEtude], [s1].[FraisHomologation], [s1].[FraisHomologationParLot], [s1].[FraisHomologationQuantiteParLot], [s1].[Libelle], [s1].[QuantiteReference], [s1].[Remarques], [s1].[TypeClient], [s1].[TypeEquipement], [s1].[UtilisateurCreation0], [s1].[UtilisateurModification0]
FROM (
    SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdAgentInstructeur], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id] AS [Id0], [s].[Code], [s].[Libelle] AS [Libelle0]
    FROM [dossiers] AS [d]
    INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
    WHERE [d].[Id] = @__request_DossierId_0
) AS [s0]
LEFT JOIN (
    SELECT [d0].[Id], [d0].[ContactEmail], [d0].[ContactNom], [d0].[DateCreation], [d0].[DateModification], [d0].[Description], [d0].[Equipement], [d0].[EstHomologable], [d0].[Fabricant], [d0].[IdCategorie], [d0].[IdDossier], [d0].[IdMotifRejet], [d0].[IdProposition], [d0].[Marque], [d0].[Modele], [d0].[NumeroDemande], [d0].[PrixUnitaire], [d0].[QuantiteEquipements], [d0].[Remise], [d0].[Type], [d0].[UtilisateurCreation], [d0].[UtilisateurModification], [c].[Id] AS [Id0], [c].[Code], [c].[DateCreation] AS [DateCreation0], [c].[DateModification] AS [DateModification0], [c].[FormuleHomologation], [c].[FraisControle], [c].[FraisEtude], [c].[FraisHomologation], [c].[FraisHomologationParLot], [c].[FraisHomologationQuantiteParLot], [c].[Libelle], [c].[QuantiteReference], [c].[Remarques], [c].[TypeClient], [c].[TypeEquipement], [c].[UtilisateurCreation] AS [UtilisateurCreation0], [c].[UtilisateurModification] AS [UtilisateurModification0]
    FROM [demandes] AS [d0]
    LEFT JOIN [categoriesEquipements] AS [c] ON [d0].[IdCategorie] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[IdDossier]
ORDER BY [s0].[Id], [s0].[Id0], [s1].[Id]
2026-01-16 03:21:35.387 +01:00 [INF] Début de la création du devis pour le dossier "8873f2cf-5cae-4779-bfbf-9e3369736f2e"
2026-01-16 03:21:35.390 +01:00 [WRN] La demande "eb0e4fd1-adda-4c9c-b46e-0b35704765cb" n'a pas de catégorie assignée. Ses frais ne seront pas inclus dans le devis.
2026-01-16 03:21:35.434 +01:00 [INF] Devis créé en mémoire pour le dossier "8873f2cf-5cae-4779-bfbf-9e3369736f2e".
2026-01-16 03:21:35.454 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__statutCibleCode_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = @__statutCibleCode_0
2026-01-16 03:21:35.461 +01:00 [INF] Le statut du dossier "8873f2cf-5cae-4779-bfbf-9e3369736f2e" a été changé à 'Instruction Approuvée'.
2026-01-16 03:21:35.468 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AdminProfilsId], [a].[ChangementMotPasse], [a].[Compte], [a].[DateCreation], [a].[DateModification], [a].[DerniereConnexion], [a].[Desactive], [a].[IdProfil], [a].[IdUtilisateurType], [a].[MotPasse], [a].[Nom], [a].[Prenoms], [a].[Remarques], [a].[UtilisateurCreation], [a].[UtilisateurModification]
FROM [AdminUtilisateurs] AS [a]
WHERE [a].[Id] = @__p_0
2026-01-16 03:21:35.585 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 512), @p2='?' (DbType = Int64), @p3='?' (DbType = Int64), @p4='?' (DbType = Int64), @p5='?' (DbType = Guid), @p6='?' (Size = 60), @p7='?' (Size = 512), @p8='?' (Size = 60), @p9='?' (Size = 60), @p10='?' (DbType = Guid), @p11='?' (DbType = Int64), @p12='?' (DbType = Int64), @p13='?' (DbType = Int64), @p14='?' (DbType = Guid), @p15='?' (DbType = Guid), @p16='?' (DbType = Currency), @p17='?' (DbType = Currency), @p18='?' (DbType = Currency), @p19='?' (Size = 60), @p20='?' (Size = 1) (DbType = Byte), @p21='?' (Size = 60), @p22='?' (Size = 60), @p26='?' (DbType = Guid), @p23='?' (DbType = Int64), @p24='?' (DbType = Guid), @p25='?' (Size = 60)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [commentaires] ([Id], [commentaire], [DateCommentaire], [DateCreation], [DateModification], [IdDossier], [NomInstructeur], [Proposition], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
INSERT INTO [devis] ([Id], [Date], [DateCreation], [DateModification], [IdDemande], [IdDossier], [MontantControle], [MontantEtude], [MontantHomologation], [PaiementMobileId], [PaiementOk], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
UPDATE [dossiers] SET [DateModification] = @p23, [IdStatut] = @p24, [UtilisateurModification] = @p25
OUTPUT 1
WHERE [Id] = @p26;
2026-01-16 03:21:35.602 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__eventTypeCode_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[Code], [a].[Libelle]
FROM [adminEvenementsTypes] AS [a]
WHERE [a].[Code] = @__eventTypeCode_0
2026-01-16 03:21:35.617 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 120), @p2='?' (Size = 120), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (Size = 255), @p8='?' (Size = 120), @p9='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [adminJournal] ([Id], [AdresseIP], [Application], [DateEvenement], [DossierId], [IdDossier], [IdEvenementType], [Libelle], [Page], [Utilisateur])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2026-01-16 03:21:35.671 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?' (DbType = Int64), @p3='?' (DbType = Int64), @p4='?' (Size = 100), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (Size = 1000), @p8='?' (Size = 100), @p9='?' (Size = 500), @p10='?' (Size = 200), @p11='?' (Size = 50), @p12='?' (DbType = Guid), @p13='?' (Size = 4000), @p14='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [notifications] ([Id], [DateCreation], [DateEnvoi], [DateModification], [EntityId], [IsBroadcast], [IsRead], [Message], [ProfilCode], [TargetUrl], [Title], [Type], [UserId], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
