2025-12-06 14:11:41.143 +01:00 [INF] Now listening on: https://localhost:7016
2025-12-06 14:11:41.177 +01:00 [INF] Now listening on: http://localhost:5041
2025-12-06 14:11:41.284 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-06 14:11:41.307 +01:00 [INF] Hosting environment: Development
2025-12-06 14:11:41.313 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api
2025-12-06 14:13:07.091 +01:00 [FTL] Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Program.cs:line 131
2025-12-06 14:13:35.587 +01:00 [FTL] Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Program.cs:line 131
2025-12-06 14:34:18.247 +01:00 [FTL] Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Program.cs:line 131
2025-12-06 14:34:38.360 +01:00 [FTL] Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Program.cs:line 131
2025-12-06 14:42:50.074 +01:00 [INF] Now listening on: https://localhost:7016
2025-12-06 14:42:50.113 +01:00 [INF] Now listening on: http://localhost:5041
2025-12-06 14:42:50.190 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-06 14:42:50.196 +01:00 [INF] Hosting environment: Development
2025-12-06 14:42:50.198 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api
2025-12-06 14:42:53.324 +01:00 [INF] HTTP GET /index.html responded 200 in 127.1044 ms
2025-12-06 14:42:53.744 +01:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 98.1852 ms
2025-12-06 14:50:38.607 +01:00 [INF] Executed DbCommand (182ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 14:50:39.735 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 255), @p2='?' (Size = 60), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 30), @p5='?' (Size = 60), @p6='?' (Size = 60), @p7='?' (Size = 30), @p8='?' (DbType = DateTime), @p9='?' (DbType = DateTime), @p10='?' (Size = 1) (DbType = Byte), @p11='?' (Size = 120), @p12='?' (Size = 255), @p13='?' (Size = 100), @p14='?' (Size = 120), @p15='?' (Size = 60), @p16='?' (Size = 512), @p17='?' (Size = 20), @p18='?' (Size = 60), @p19='?' (Size = 60), @p20='?' (Size = 6), @p21='?' (DbType = DateTime2), @p22='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [clients] ([Id], [Adresse], [Bp], [ChangementMotPasse], [Code], [ContactFonction], [ContactNom], [ContactTelephone], [DateCreation], [DateModification], [Desactive], [Email], [MotPasse], [Pays], [RaisonSociale], [RegistreCommerce], [Remarques], [TypeClient], [UtilisateurCreation], [UtilisateurModification], [VerificationCode], [VerificationTokenExpiry], [Ville])
OUTPUT INSERTED.[IsVerified], INSERTED.[NiveauValidation]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-12-06 14:50:48.205 +01:00 [INF] HTTP POST /api/auth/register responded 200 in 14276.1597 ms
2025-12-06 14:51:58.566 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__get_Item_0
2025-12-06 14:51:58.601 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (DbType = Boolean), @p2='?' (DbType = Int32), @p3='?' (Size = 60), @p4='?' (Size = 6), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [clients] SET [DateModification] = @p0, [IsVerified] = @p1, [NiveauValidation] = @p2, [UtilisateurModification] = @p3, [VerificationCode] = @p4, [VerificationTokenExpiry] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2025-12-06 14:51:58.613 +01:00 [INF] HTTP POST /api/auth/confirm-account responded 200 in 252.5824 ms
2025-12-06 14:52:11.408 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__userId_Value_0
2025-12-06 14:52:11.426 +01:00 [INF] HTTP POST /api/auth/connect-by-token responded 200 in 133.7042 ms
2025-12-06 14:52:49.417 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 14:52:49.948 +01:00 [ERR] HTTP POST /api/auth/login responded 500 in 556.6155 ms
FrontOffice.Application.Common.Exceptions.AccountPendingValidationException: Votre compte est en attente de validation
   at FrontOffice.Application.Features.Authentication.Queries.Login.LoginClientQueryHandler.Handle(LoginClientQuery request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Authentication\Queries\Login\LoginClientQueryHandler.cs:line 58
   at FrontOffice.Api.Controllers.AuthenticationController.Login(LoginClientQuery query) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\AuthenticationController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-12-06 14:56:12.613 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 14:56:12.848 +01:00 [INF] HTTP POST /api/auth/login responded 200 in 246.3062 ms
2025-12-06 14:56:57.351 +01:00 [INF] Executed DbCommand (33ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 14:56:57.370 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 215.1229 ms
2025-12-06 15:02:47.242 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_Libelle_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [dossiers] AS [d]
        WHERE [d].[Libelle] = @__request_Libelle_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-06 15:02:47.263 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'NouveauDossier'
2025-12-06 15:02:47.377 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Date), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (Size = 120), @p8='?' (Size = 30), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [dossiers] ([Id], [DateCreation], [DateModification], [DateOuverture], [IdClient], [IdModeReglement], [IdStatut], [Libelle], [Numero], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-12-06 15:02:47.461 +01:00 [INF] Executed DbCommand (53ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 36), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2025-12-06 15:02:47.499 +01:00 [INF] HTTP POST /api/dossiers responded 201 in 350.0192 ms
2025-12-06 15:05:22.318 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_IdDossier_0='?' (DbType = Guid), @__userId_Value_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
FROM [dossiers] AS [d]
WHERE [d].[Id] = @__request_IdDossier_0 AND [d].[IdClient] = @__userId_Value_1
2025-12-06 15:05:22.443 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 60), @p2='?' (Size = 60), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 512), @p6='?' (Size = 120), @p7='?' (Size = 120), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (Size = 120), @p13='?' (Size = 120), @p14='?' (Size = 12), @p15='?' (DbType = Currency), @p16='?' (DbType = Int32), @p17='?' (Precision = 5) (Scale = 2) (DbType = Decimal), @p18='?' (Size = 120), @p19='?' (Size = 4000), @p20='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [demandes] ([Id], [ContactEmail], [ContactNom], [DateCreation], [DateModification], [Description], [Equipement], [Fabricant], [IdCategorie], [IdDossier], [IdMotifRejet], [IdProposition], [Marque], [Modele], [NumeroDemande], [PrixUnitaire], [QuantiteEquipements], [Remise], [Type], [UtilisateurCreation], [UtilisateurModification])
OUTPUT INSERTED.[EstHomologable]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
2025-12-06 15:05:22.487 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 29), @IDDemande='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDemande @fichier, @nom, @IDDemande, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2025-12-06 15:05:22.499 +01:00 [INF] HTTP POST /api/dossiers/7f766ca5-2e79-46da-80f7-e5b62ac9e6e0/equipements responded 200 in 255.5355 ms
2025-12-06 16:32:31.991 +01:00 [INF] HTTP GET /api/dossiers responded 401 in 18.0535 ms
2025-12-06 16:32:49.000 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 16:32:49.272 +01:00 [INF] HTTP POST /api/auth/login responded 200 in 329.0756 ms
2025-12-06 16:33:32.074 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 16:33:32.125 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 16:33:32.164 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 130.7517 ms
2025-12-06 17:52:01.768 +01:00 [INF] Now listening on: https://localhost:7016
2025-12-06 17:52:01.808 +01:00 [INF] Now listening on: http://localhost:5041
2025-12-06 17:52:01.864 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-06 17:52:01.867 +01:00 [INF] Hosting environment: Development
2025-12-06 17:52:01.870 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api
2025-12-06 17:54:55.604 +01:00 [INF] HTTP GET /api/dossiers responded 401 in 195.6069 ms
2025-12-06 17:55:09.693 +01:00 [INF] Executed DbCommand (80ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 17:55:10.487 +01:00 [INF] HTTP POST /api/auth/login responded 200 in 3176.7405 ms
2025-12-06 17:55:45.105 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 17:55:45.208 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 17:55:45.322 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 392.6326 ms
2025-12-06 17:56:56.276 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 17:56:56.288 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 17:56:56.299 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 131.4515 ms
2025-12-06 18:00:13.478 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 18:00:13.490 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 18:00:13.494 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 49.6836 ms
2025-12-06 18:00:52.964 +01:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-12-06 18:00:52.998 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id], [d0].[Id], [d0].[ContactEmail], [d0].[ContactNom], [d0].[DateCreation], [d0].[DateModification], [d0].[Description], [d0].[Equipement], [d0].[EstHomologable], [d0].[Fabricant], [d0].[IdCategorie], [d0].[IdDossier], [d0].[IdMotifRejet], [d0].[IdProposition], [d0].[Marque], [d0].[Modele], [d0].[NumeroDemande], [d0].[PrixUnitaire], [d0].[QuantiteEquipements], [d0].[Remise], [d0].[Type], [d0].[UtilisateurCreation], [d0].[UtilisateurModification], [s].[Code], [s].[Libelle], [d1].[Id], [d1].[Date], [d1].[DateCreation], [d1].[DateModification], [d1].[DossierId], [d1].[IdDemande], [d1].[MontantControle], [d1].[MontantEtude], [d1].[MontantHomologation], [d1].[PaiementMobileId], [d1].[PaiementOk], [d1].[UtilisateurCreation], [d1].[UtilisateurModification]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
LEFT JOIN [demandes] AS [d0] ON [d].[Id] = [d0].[IdDossier]
LEFT JOIN [devis] AS [d1] ON [d].[Id] = [d1].[DossierId]
WHERE [d].[IdClient] = @__userId_Value_0
ORDER BY [d].[Id], [s].[Id], [d0].[Id]
2025-12-06 18:00:53.096 +01:00 [INF] HTTP GET /api/dossiers/apercu responded 200 in 230.5864 ms
2025-12-06 18:01:02.050 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[IdClient], [d].[IdStatut], [d].[IdModeReglement], [d].[DateOuverture], [d].[Numero], [d].[Libelle], CAST(1 AS bit), [s].[Id], [s].[Code], [s].[Libelle], [d0].[Id], [d0].[IdDossier], [d0].[NumeroDemande], [d0].[Equipement], [d0].[Modele], [d0].[Marque]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
LEFT JOIN [demandes] AS [d0] ON [d].[Id] = [d0].[IdDossier]
WHERE [d].[IdClient] = @__userId_Value_0
ORDER BY [d].[DateOuverture] DESC, [d].[Id], [s].[Id]
2025-12-06 18:01:02.100 +01:00 [INF] HTTP GET /api/dossiers/recents responded 200 in 127.6319 ms
2025-12-06 18:01:50.259 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutCible_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutCible_1
2025-12-06 18:01:50.291 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutCible_1='?' (Size = 120), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [t].[Id0], [t].[Code], [t].[Libelle0], [d0].[Id], [d0].[Date], [d0].[DateCreation], [d0].[DateModification], [d0].[DossierId], [d0].[IdDemande], [d0].[MontantControle], [d0].[MontantEtude], [d0].[MontantHomologation], [d0].[PaiementMobileId], [d0].[PaiementOk], [d0].[UtilisateurCreation], [d0].[UtilisateurModification]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id] AS [Id0], [s].[Code], [s].[Libelle] AS [Libelle0]
    FROM [dossiers] AS [d]
    INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
    WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutCible_1
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t]
LEFT JOIN [devis] AS [d0] ON [t].[Id] = [d0].[DossierId]
ORDER BY [t].[DateOuverture] DESC, [t].[Id], [t].[Id0]
2025-12-06 18:01:50.301 +01:00 [INF] HTTP GET /api/dossiers/devis-non-valides responded 200 in 69.9361 ms
2025-12-06 18:02:39.078 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_DossierId_0='?' (DbType = Guid), @__userId_Value_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[Id] = @__request_DossierId_0 AND [d].[IdClient] = @__userId_Value_1
2025-12-06 18:02:39.100 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'DevisValide'
2025-12-06 18:02:39.280 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [dossiers] SET [DateModification] = @p0, [IdStatut] = @p1, [UtilisateurModification] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2025-12-06 18:02:39.307 +01:00 [INF] HTTP POST /api/dossiers/7f766ca5-2e79-46da-80f7-e5b62ac9e6e0/valider-devis responded 200 in 254.2419 ms
2025-12-06 18:02:50.148 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 18:02:50.163 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 18:02:50.169 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 26.3064 ms
2025-12-06 18:04:24.627 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 18:04:24.639 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 18:04:24.646 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 31.7272 ms
2025-12-06 18:04:31.051 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 18:04:31.062 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 18:04:31.069 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 20.7069 ms
2025-12-06 18:07:12.762 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 18:07:12.771 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 18:07:12.780 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 68.1471 ms
2025-12-06 18:07:47.355 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:07:47.369 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 75.7966 ms
2025-12-06 18:07:48.544 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:07:48.553 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 30.6152 ms
2025-12-06 18:08:12.013 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:08:12.019 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 35.6953 ms
2025-12-06 18:08:13.030 +01:00 [INF] Executed DbCommand (43ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:08:13.034 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 49.1609 ms
2025-12-06 18:08:13.859 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:08:13.865 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 30.6412 ms
2025-12-06 18:08:14.769 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:08:14.796 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 30.0377 ms
2025-12-06 18:14:50.749 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@__request_DossierId_0='?' (DbType = Guid), @__userId_Value_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [t0].[Id], [t0].[Date], [t0].[DateCreation], [t0].[DateModification], [t0].[DossierId], [t0].[IdDemande], [t0].[MontantControle], [t0].[MontantEtude], [t0].[MontantHomologation], [t0].[PaiementMobileId], [t0].[PaiementOk], [t0].[UtilisateurCreation], [t0].[UtilisateurModification]
FROM (
    SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[Id] = @__request_DossierId_0 AND [d].[IdClient] = @__userId_Value_1
) AS [t]
LEFT JOIN (
    SELECT [t1].[Id], [t1].[Date], [t1].[DateCreation], [t1].[DateModification], [t1].[DossierId], [t1].[IdDemande], [t1].[MontantControle], [t1].[MontantEtude], [t1].[MontantHomologation], [t1].[PaiementMobileId], [t1].[PaiementOk], [t1].[UtilisateurCreation], [t1].[UtilisateurModification], [t1].[IdDossier]
    FROM (
        SELECT [d1].[Id], [d1].[Date], [d1].[DateCreation], [d1].[DateModification], [d1].[DossierId], [d1].[IdDemande], [d1].[MontantControle], [d1].[MontantEtude], [d1].[MontantHomologation], [d1].[PaiementMobileId], [d1].[PaiementOk], [d1].[UtilisateurCreation], [d1].[UtilisateurModification], [d0].[IdDossier], ROW_NUMBER() OVER(PARTITION BY [d0].[IdDossier] ORDER BY [d0].[Id], [d1].[Id]) AS [row]
        FROM [demandes] AS [d0]
        INNER JOIN [devis] AS [d1] ON [d0].[Id] = [d1].[IdDemande]
        WHERE [d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL
    ) AS [t1]
    WHERE [t1].[row] <= 1
) AS [t0] ON [t].[Id] = [t0].[IdDossier]
2025-12-06 18:14:50.803 +01:00 [INF] Start processing HTTP request POST https://sandbox.momodeveloper.mtn.com/collection/token/
2025-12-06 18:14:50.809 +01:00 [INF] Sending HTTP request POST https://sandbox.momodeveloper.mtn.com/collection/token/
2025-12-06 18:14:51.541 +01:00 [INF] Received HTTP response headers after 724.8795ms - 401
2025-12-06 18:14:51.550 +01:00 [INF] End processing HTTP request after 751.9462ms - 401
2025-12-06 18:14:51.776 +01:00 [ERR] HTTP POST /api/paiements/dossier/7f766ca5-2e79-46da-80f7-e5b62ac9e6e0/momo responded 500 in 1102.6733 ms
System.Net.Http.HttpRequestException: Response status code does not indicate success: 401 (Access Denied).
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at FrontOffice.Infrastructure.Services.MomoPaymentService.GetAccessTokenAsync() in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Infrastructure\Services\MomoPaymentService.cs:line 44
   at FrontOffice.Application.Features.Paiements.Commands.PayByMomo.PayByMomoCommandHandler.Handle(PayByMomoCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Paiements\Commands\PayByMomo\PayByMomoCommandHandler.cs:line 55
   at PaiementsController.PayByMomo(Guid dossierId, PayByMomoCommand command) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\PaiementsController.cs:line 22
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-12-06 18:14:51.995 +01:00 [ERR] Une exception non gre a t intercepte par le middleware.
System.Net.Http.HttpRequestException: Response status code does not indicate success: 401 (Access Denied).
   at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()
   at FrontOffice.Infrastructure.Services.MomoPaymentService.GetAccessTokenAsync() in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Infrastructure\Services\MomoPaymentService.cs:line 44
   at FrontOffice.Application.Features.Paiements.Commands.PayByMomo.PayByMomoCommandHandler.Handle(PayByMomoCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Paiements\Commands\PayByMomo\PayByMomoCommandHandler.cs:line 55
   at PaiementsController.PayByMomo(Guid dossierId, PayByMomoCommand command) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\PaiementsController.cs:line 22
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at FrontOffice.Api.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Middleware\ErrorHandlingMiddleware.cs:line 34
2025-12-06 18:43:18.166 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:43:18.172 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 47.8832 ms
2025-12-06 18:43:19.688 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 18:43:19.696 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 36.8560 ms
2025-12-06 22:37:02.199 +01:00 [INF] Now listening on: https://localhost:7016
2025-12-06 22:37:02.247 +01:00 [INF] Now listening on: http://localhost:5041
2025-12-06 22:37:02.432 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-06 22:37:02.458 +01:00 [INF] Hosting environment: Development
2025-12-06 22:37:02.470 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api
2025-12-06 22:37:39.269 +01:00 [INF] Executed DbCommand (197ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 22:37:40.877 +01:00 [INF] HTTP POST /api/auth/login responded 200 in 7773.6846 ms
2025-12-06 22:38:30.299 +01:00 [INF] Executed DbCommand (108ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 22:38:30.381 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 1163.5368 ms
2025-12-06 22:42:18.588 +01:00 [FTL] Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Program.cs:line 131
2025-12-06 22:42:47.646 +01:00 [FTL] Application terminated unexpectedly
Microsoft.Extensions.Hosting.HostAbortedException: The host was aborted.
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.ThrowHostAborted()
   at Microsoft.Extensions.Hosting.HostFactoryResolver.HostingListener.OnNext(KeyValuePair`2 value)
   at System.Diagnostics.DiagnosticListener.Write(String name, Object value)
   at Microsoft.Extensions.Hosting.HostBuilder.ResolveHost(IServiceProvider serviceProvider, DiagnosticListener diagnosticListener)
   at Microsoft.Extensions.Hosting.HostApplicationBuilder.Build()
   at Microsoft.AspNetCore.Builder.WebApplicationBuilder.Build()
   at Program.<Main>$(String[] args) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Program.cs:line 131
2025-12-06 22:43:02.660 +01:00 [INF] Now listening on: https://localhost:7016
2025-12-06 22:43:02.736 +01:00 [INF] Now listening on: http://localhost:5041
2025-12-06 22:43:02.886 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-06 22:43:02.893 +01:00 [INF] Hosting environment: Development
2025-12-06 22:43:02.903 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api
2025-12-06 22:44:52.326 +01:00 [INF] Executed DbCommand (227ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 22:44:54.336 +01:00 [INF] Executed DbCommand (48ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 255), @p2='?' (Size = 60), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 30), @p5='?' (Size = 60), @p6='?' (Size = 60), @p7='?' (Size = 30), @p8='?' (DbType = DateTime), @p9='?' (DbType = DateTime), @p10='?' (Size = 1) (DbType = Byte), @p11='?' (Size = 120), @p12='?' (Size = 255), @p13='?' (Size = 100), @p14='?' (Size = 120), @p15='?' (Size = 60), @p16='?' (Size = 512), @p17='?' (Size = 20), @p18='?' (Size = 60), @p19='?' (Size = 60), @p20='?' (Size = 6), @p21='?' (DbType = DateTime2), @p22='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [clients] ([Id], [Adresse], [Bp], [ChangementMotPasse], [Code], [ContactFonction], [ContactNom], [ContactTelephone], [DateCreation], [DateModification], [Desactive], [Email], [MotPasse], [Pays], [RaisonSociale], [RegistreCommerce], [Remarques], [TypeClient], [UtilisateurCreation], [UtilisateurModification], [VerificationCode], [VerificationTokenExpiry], [Ville])
OUTPUT INSERTED.[IsVerified], INSERTED.[NiveauValidation]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2025-12-06 22:45:02.599 +01:00 [INF] HTTP POST /api/auth/register responded 200 in 18016.7597 ms
2025-12-06 22:46:14.539 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__get_Item_0
2025-12-06 22:46:14.779 +01:00 [ERR] HTTP POST /api/auth/confirm-account responded 500 in 475.9607 ms
System.InvalidOperationException: Compte utilisateur introuvable.
   at FrontOffice.Application.Features.Authentication.Commands.ConfirmAccount.ConfirmAccountCommandHandler.Handle(ConfirmAccountCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Authentication\Commands\ConfirmAccount\ConfirmAccountCommandHandler.cs:line 37
   at FrontOffice.Api.Controllers.AuthenticationController.ConfirmAccount(ConfirmAccountCommand command) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\AuthenticationController.cs:line 50
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-12-06 22:47:18.113 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__get_Item_0
2025-12-06 22:47:18.209 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (DbType = Boolean), @p2='?' (DbType = Int32), @p3='?' (Size = 60), @p4='?' (Size = 6), @p5='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [clients] SET [DateModification] = @p0, [IsVerified] = @p1, [NiveauValidation] = @p2, [UtilisateurModification] = @p3, [VerificationCode] = @p4, [VerificationTokenExpiry] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2025-12-06 22:47:18.264 +01:00 [INF] HTTP POST /api/auth/confirm-account responded 200 in 515.2390 ms
2025-12-06 22:47:30.738 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 22:47:31.869 +01:00 [ERR] HTTP POST /api/auth/login responded 500 in 1193.7092 ms
FrontOffice.Application.Common.Exceptions.AccountPendingValidationException: Votre compte est en attente de validation
   at FrontOffice.Application.Features.Authentication.Queries.Login.LoginClientQueryHandler.Handle(LoginClientQuery request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Authentication\Queries\Login\LoginClientQueryHandler.cs:line 58
   at FrontOffice.Api.Controllers.AuthenticationController.Login(LoginClientQuery query) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\AuthenticationController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-12-06 22:48:14.183 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2025-12-06 22:48:14.921 +01:00 [INF] HTTP POST /api/auth/login responded 200 in 851.5138 ms
2025-12-06 22:50:06.164 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__request_Libelle_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [dossiers] AS [d]
        WHERE [d].[Libelle] = @__request_Libelle_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-06 22:50:06.205 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'NouveauDossier'
2025-12-06 22:50:06.362 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Date), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (Size = 120), @p8='?' (Size = 30), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [dossiers] ([Id], [DateCreation], [DateModification], [DateOuverture], [IdClient], [IdModeReglement], [IdStatut], [Libelle], [Numero], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-12-06 22:50:06.443 +01:00 [ERR] Failed executing DbCommand (36ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 36), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2025-12-06 22:50:06.631 +01:00 [ERR] chec de l'importation du document via la procdure stocke. La cration du dossier a t annule.
Microsoft.Data.SqlClient.SqlException (0x80131904): Procdure stocke'ImporterDocumentDossier' introuvable.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteNonQuery(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteNonQueryAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<InternalExecuteNonQueryAsync>b__210_1(IAsyncResult result)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteNonQueryAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.RelationalDatabaseFacadeExtensions.ExecuteSqlRawAsync(DatabaseFacade databaseFacade, String sql, IEnumerable`1 parameters, CancellationToken cancellationToken)
   at FrontOffice.Infrastructure.Services.DatabaseFileStorageProvider.ImportDocumentDossierAsync(IFormFile file, String nom, Byte type, Guid dossierId) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Infrastructure\Services\DatabaseFileStorageProvider.cs:line 48
   at FrontOffice.Application.Features.Demandes.Commands.CreateDossier.CreateDossierCommandHandler.Handle(CreateDossierCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Demandes\Commands\CreateDossier\CreateDossierCommandHandler.cs:line 87
ClientConnectionId:07f7c4f7-1995-46e1-81d4-e4b50bbae763
Error Number:2812,State:62,Class:16
2025-12-06 22:50:06.853 +01:00 [ERR] HTTP POST /api/dossiers responded 500 in 815.7195 ms
System.InvalidOperationException: chec de la cration du document : Procdure stocke'ImporterDocumentDossier' introuvable.
   at FrontOffice.Application.Features.Demandes.Commands.CreateDossier.CreateDossierCommandHandler.Handle(CreateDossierCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Demandes\Commands\CreateDossier\CreateDossierCommandHandler.cs:line 101
   at FrontOffice.Api.Controllers.DossiersController.CreateDossier(CreateDossierCommand command) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\DossiersController.cs:line 138
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-12-06 22:51:51.644 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__request_Libelle_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [dossiers] AS [d]
        WHERE [d].[Libelle] = @__request_Libelle_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-06 22:51:51.654 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'NouveauDossier'
2025-12-06 22:51:51.674 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Date), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (Size = 120), @p8='?' (Size = 30), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [dossiers] ([Id], [DateCreation], [DateModification], [DateOuverture], [IdClient], [IdModeReglement], [IdStatut], [Libelle], [Numero], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-12-06 22:51:51.736 +01:00 [INF] Executed DbCommand (42ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 36), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2025-12-06 22:51:51.792 +01:00 [INF] HTTP POST /api/dossiers responded 201 in 246.3097 ms
2025-12-06 22:55:46.117 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_Libelle_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [dossiers] AS [d]
        WHERE [d].[Libelle] = @__request_Libelle_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-06 22:55:46.132 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'NouveauDossier'
2025-12-06 22:55:46.150 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Date), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (Size = 120), @p8='?' (Size = 30), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [dossiers] ([Id], [DateCreation], [DateModification], [DateOuverture], [IdClient], [IdModeReglement], [IdStatut], [Libelle], [Numero], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-12-06 22:55:46.215 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 36), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2025-12-06 22:55:46.226 +01:00 [INF] HTTP POST /api/dossiers responded 201 in 168.4426 ms
2025-12-06 23:02:49.109 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 23:02:49.399 +01:00 [INF] Executed DbCommand (40ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 23:02:49.532 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 786.2485 ms
2025-12-06 23:09:00.352 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__request_IdDossier_0='?' (DbType = Guid), @__userId_Value_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
FROM [dossiers] AS [d]
WHERE [d].[Id] = @__request_IdDossier_0 AND [d].[IdClient] = @__userId_Value_1
2025-12-06 23:09:00.617 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 60), @p2='?' (Size = 60), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (Size = 512), @p6='?' (Size = 120), @p7='?' (Size = 120), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?' (DbType = Guid), @p11='?' (DbType = Guid), @p12='?' (Size = 120), @p13='?' (Size = 120), @p14='?' (Size = 12), @p15='?' (DbType = Currency), @p16='?' (DbType = Int32), @p17='?' (Precision = 5) (Scale = 2) (DbType = Decimal), @p18='?' (Size = 120), @p19='?' (Size = 4000), @p20='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [demandes] ([Id], [ContactEmail], [ContactNom], [DateCreation], [DateModification], [Description], [Equipement], [Fabricant], [IdCategorie], [IdDossier], [IdMotifRejet], [IdProposition], [Marque], [Modele], [NumeroDemande], [PrixUnitaire], [QuantiteEquipements], [Remise], [Type], [UtilisateurCreation], [UtilisateurModification])
OUTPUT INSERTED.[EstHomologable]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20);
2025-12-06 23:09:00.761 +01:00 [INF] Executed DbCommand (92ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 29), @IDDemande='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDemande @fichier, @nom, @IDDemande, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2025-12-06 23:09:00.798 +01:00 [INF] HTTP POST /api/dossiers/8B16FA6E-06DA-4843-BC3A-1DC181AD26F2/equipements responded 200 in 515.3885 ms
2025-12-06 23:09:43.423 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 23:09:43.465 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 23:09:43.476 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 98.9259 ms
2025-12-06 23:10:08.945 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutCible_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutCible_1
2025-12-06 23:10:09.167 +01:00 [INF] Executed DbCommand (37ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutCible_1='?' (Size = 120), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [t].[Id0], [t].[Code], [t].[Libelle0], [d0].[Id], [d0].[Date], [d0].[DateCreation], [d0].[DateModification], [d0].[DossierId], [d0].[IdDemande], [d0].[MontantControle], [d0].[MontantEtude], [d0].[MontantHomologation], [d0].[PaiementMobileId], [d0].[PaiementOk], [d0].[UtilisateurCreation], [d0].[UtilisateurModification]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id] AS [Id0], [s].[Code], [s].[Libelle] AS [Libelle0]
    FROM [dossiers] AS [d]
    INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
    WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutCible_1
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t]
LEFT JOIN [devis] AS [d0] ON [t].[Id] = [d0].[DossierId]
ORDER BY [t].[DateOuverture] DESC, [t].[Id], [t].[Id0]
2025-12-06 23:10:09.185 +01:00 [INF] HTTP GET /api/dossiers/devis-non-valides responded 200 in 359.1948 ms
2025-12-06 23:10:38.889 +01:00 [INF] Executed DbCommand (18ms) [Parameters=[@__request_DossierId_0='?' (DbType = Guid), @__userId_Value_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[Id] = @__request_DossierId_0 AND [d].[IdClient] = @__userId_Value_1
2025-12-06 23:10:38.937 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'DevisValide'
2025-12-06 23:10:39.020 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Guid), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [dossiers] SET [DateModification] = @p0, [IdStatut] = @p1, [UtilisateurModification] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2025-12-06 23:10:39.049 +01:00 [INF] HTTP POST /api/dossiers/8B16FA6E-06DA-4843-BC3A-1DC181AD26F2/valider-devis responded 200 in 257.1345 ms
2025-12-06 23:10:51.643 +01:00 [INF] Executed DbCommand (33ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutCible_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutCible_1
2025-12-06 23:10:51.660 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutCible_1='?' (Size = 120), @__p_2='?' (DbType = Int32), @__p_3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [t].[Id0], [t].[Code], [t].[Libelle0], [d0].[Id], [d0].[Date], [d0].[DateCreation], [d0].[DateModification], [d0].[DossierId], [d0].[IdDemande], [d0].[MontantControle], [d0].[MontantEtude], [d0].[MontantHomologation], [d0].[PaiementMobileId], [d0].[PaiementOk], [d0].[UtilisateurCreation], [d0].[UtilisateurModification]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification], [s].[Id] AS [Id0], [s].[Code], [s].[Libelle] AS [Libelle0]
    FROM [dossiers] AS [d]
    INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
    WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutCible_1
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_2 ROWS FETCH NEXT @__p_3 ROWS ONLY
) AS [t]
LEFT JOIN [devis] AS [d0] ON [t].[Id] = [d0].[DossierId]
ORDER BY [t].[DateOuverture] DESC, [t].[Id], [t].[Id0]
2025-12-06 23:10:51.669 +01:00 [INF] HTTP GET /api/dossiers/devis-non-valides responded 200 in 69.8643 ms
2025-12-06 23:11:09.563 +01:00 [INF] Executed DbCommand (66ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 23:11:09.609 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 23:11:09.631 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 149.0604 ms
2025-12-06 23:12:02.791 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [dossiers] AS [d]
WHERE [d].[IdClient] = @__userId_Value_0
2025-12-06 23:12:02.831 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[DateCreation], [t].[DateModification], [t].[DateOuverture], [t].[IdClient], [t].[IdModeReglement], [t].[IdStatut], [t].[Libelle], [t].[Numero], [t].[UtilisateurCreation], [t].[UtilisateurModification], [s].[Id], [s].[Code], [s].[Libelle]
FROM (
    SELECT [d].[Id], [d].[DateCreation], [d].[DateModification], [d].[DateOuverture], [d].[IdClient], [d].[IdModeReglement], [d].[IdStatut], [d].[Libelle], [d].[Numero], [d].[UtilisateurCreation], [d].[UtilisateurModification]
    FROM [dossiers] AS [d]
    WHERE [d].[IdClient] = @__userId_Value_0
    ORDER BY [d].[DateOuverture] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [t]
INNER JOIN [statuts] AS [s] ON [t].[IdStatut] = [s].[Id]
ORDER BY [t].[DateOuverture] DESC
2025-12-06 23:12:02.874 +01:00 [INF] HTTP GET /api/dossiers responded 200 in 131.2807 ms
2025-12-06 23:12:12.486 +01:00 [INF] Executed DbCommand (88ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d1]
    WHERE [d].[Id] = [d1].[DossierId] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) AS [Montant], COALESCE((
    SELECT TOP(1) [d2].[Date]
    FROM [devis] AS [d2]
    WHERE [d].[Id] = [d2].[DossierId] AND ([d2].[PaiementOk] <> CAST(1 AS tinyint) OR [d2].[PaiementOk] IS NULL)
    ORDER BY [d2].[Date] DESC), '0001-01-01') AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d0].[MontantEtude] + COALESCE([d0].[MontantHomologation], 0.0) + COALESCE([d0].[MontantControle], 0.0)), 0.0)
    FROM [devis] AS [d0]
    WHERE [d].[Id] = [d0].[DossierId] AND ([d0].[PaiementOk] <> CAST(1 AS tinyint) OR [d0].[PaiementOk] IS NULL)) > 0.0
2025-12-06 23:12:12.528 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 320.2943 ms
2025-12-06 23:46:23.724 +01:00 [INF] Now listening on: https://localhost:7016
2025-12-06 23:46:23.877 +01:00 [INF] Now listening on: http://localhost:5041
2025-12-06 23:46:24.128 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-06 23:46:24.136 +01:00 [INF] Hosting environment: Development
2025-12-06 23:46:24.142 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api
2025-12-06 23:46:38.720 +01:00 [INF] Executed DbCommand (363ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__statutPaiementCode_1='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[Numero] AS [NumeroDossier], (
    SELECT COALESCE(SUM([d5].[MontantEtude] + COALESCE([d5].[MontantHomologation], 0.0) + COALESCE([d5].[MontantControle], 0.0)), 0.0)
    FROM [demandes] AS [d4]
    INNER JOIN [devis] AS [d5] ON [d4].[Id] = [d5].[IdDemande]
    WHERE [d].[Id] = [d4].[IdDossier] AND ([d5].[PaiementOk] <> CAST(1 AS tinyint) OR [d5].[PaiementOk] IS NULL)) AS [Montant], (
    SELECT TOP(1) [d7].[Date]
    FROM [demandes] AS [d6]
    INNER JOIN [devis] AS [d7] ON [d6].[Id] = [d7].[IdDemande]
    WHERE [d].[Id] = [d6].[IdDossier] AND ([d7].[PaiementOk] <> CAST(1 AS tinyint) OR [d7].[PaiementOk] IS NULL)
    ORDER BY [d7].[Date] DESC) AS [DateEcheance]
FROM [dossiers] AS [d]
INNER JOIN [statuts] AS [s] ON [d].[IdStatut] = [s].[Id]
WHERE [d].[IdClient] = @__userId_Value_0 AND [s].[Code] = @__statutPaiementCode_1 AND (
    SELECT COALESCE(SUM([d1].[MontantEtude] + COALESCE([d1].[MontantHomologation], 0.0) + COALESCE([d1].[MontantControle], 0.0)), 0.0)
    FROM [demandes] AS [d0]
    INNER JOIN [devis] AS [d1] ON [d0].[Id] = [d1].[IdDemande]
    WHERE [d].[Id] = [d0].[IdDossier] AND ([d1].[PaiementOk] <> CAST(1 AS tinyint) OR [d1].[PaiementOk] IS NULL)) > 0.0 AND (
    SELECT TOP(1) CAST(1 AS bit)
    FROM [demandes] AS [d2]
    INNER JOIN [devis] AS [d3] ON [d2].[Id] = [d3].[IdDemande]
    WHERE [d].[Id] = [d2].[IdDossier] AND ([d3].[PaiementOk] <> CAST(1 AS tinyint) OR [d3].[PaiementOk] IS NULL)
    ORDER BY [d3].[Date] DESC) = CAST(1 AS bit)
2025-12-06 23:46:38.922 +01:00 [INF] HTTP GET /api/dossiers/paiements-en-attente responded 200 in 14630.4338 ms
