2026-01-08 17:17:01.728 +01:00 [INF] Now listening on: https://localhost:7016
2026-01-08 17:17:01.776 +01:00 [INF] Now listening on: http://localhost:5041
2026-01-08 17:17:01.864 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-08 17:17:01.867 +01:00 [INF] Hosting environment: Development
2026-01-08 17:17:01.870 +01:00 [INF] Content root path: D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api
2026-01-08 17:31:53.190 +01:00 [INF] HTTP GET /index.html responded 200 in 103.8823 ms
2026-01-08 17:31:53.291 +01:00 [INF] HTTP GET /css/swagger-custom.css responded 304 in 52.0895 ms
2026-01-08 17:31:53.600 +01:00 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 85.9993 ms
2026-01-08 17:34:14.412 +01:00 [INF] Executed DbCommand (148ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2026-01-08 17:34:14.568 +01:00 [INF] Demande de renvoi de code OTP pour le client orichekaya2@gmail.com
2026-01-08 17:34:14.734 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = Int64), @p1='?' (Size = 6), @p2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [clients] SET [DateModification] = @p0, [VerificationCode] = @p1, [VerificationTokenExpiry] = @p2
OUTPUT 1
WHERE [Id] = @p3;
2026-01-08 17:34:15.239 +01:00 [INF] Connexion au serveur SMTP smtp.sendgrid.net sur le port 587 avec l'option "StartTls"...
2026-01-08 17:34:17.742 +01:00 [INF] Authentification avec l'utilisateur 'apikey'...
2026-01-08 17:34:18.156 +01:00 [INF] Envoi de l'email à 'orichekaya2@gmail.com'...
2026-01-08 17:34:19.257 +01:00 [INF] Email envoyé avec succès.
2026-01-08 17:34:19.282 +01:00 [INF] HTTP POST /api/auth/register responded 200 in 11412.9011 ms
2026-01-08 17:38:34.687 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__get_Item_0
2026-01-08 17:38:34.703 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = Int64), @p1='?' (DbType = Boolean), @p2='?' (DbType = Int32), @p3='?' (Size = 60), @p4='?' (Size = 6), @p5='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [clients] SET [DateModification] = @p0, [IsVerified] = @p1, [NiveauValidation] = @p2, [UtilisateurModification] = @p3, [VerificationCode] = @p4, [VerificationTokenExpiry] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2026-01-08 17:38:34.713 +01:00 [INF] HTTP POST /api/auth/confirm-account responded 200 in 197.2416 ms
2026-01-08 17:38:46.699 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__userId_Value_0
2026-01-08 17:38:46.881 +01:00 [ERR] HTTP POST /api/auth/connect-by-token responded 500 in 326.3234 ms
FrontOffice.Application.Common.Exceptions.AccountPendingValidationException: Votre compte est en attente de validation par l'administration (Niveau 2 requis).
   at FrontOffice.Application.Features.Authentication.Queries.ConnectByToken.ConnectByTokenQueryHandler.Handle(ConnectByTokenQuery request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Authentication\Queries\ConnectByToken\ConnectByTokenQueryHandler.cs:line 38
   at FrontOffice.Api.Controllers.AuthenticationController.ConnectByToken() in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\AuthenticationController.cs:line 67
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2026-01-08 17:43:23.005 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2026-01-08 17:43:23.588 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 255), @p2='?' (Size = 60), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 30), @p5='?' (Size = 60), @p6='?' (Size = 60), @p7='?' (Size = 30), @p8='?' (DbType = Int64), @p9='?' (DbType = Int64), @p10='?' (Size = 1) (DbType = Byte), @p11='?' (Size = 120), @p12='?' (Size = 255), @p13='?' (Size = 100), @p14='?' (Size = 120), @p15='?' (Size = 60), @p16='?' (Size = 512), @p17='?' (Size = 20), @p18='?' (Size = 60), @p19='?' (Size = 60), @p20='?' (Size = 6), @p21='?' (DbType = Int64), @p22='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [clients] ([Id], [Adresse], [Bp], [ChangementMotPasse], [Code], [ContactFonction], [ContactNom], [ContactTelephone], [DateCreation], [DateModification], [Desactive], [Email], [MotPasse], [Pays], [RaisonSociale], [RegistreCommerce], [Remarques], [TypeClient], [UtilisateurCreation], [UtilisateurModification], [VerificationCode], [VerificationTokenExpiry], [Ville])
OUTPUT INSERTED.[IsVerified], INSERTED.[NiveauValidation]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22);
2026-01-08 17:43:23.614 +01:00 [INF] Connexion au serveur SMTP smtp.sendgrid.net sur le port 587 avec l'option "StartTls"...
2026-01-08 17:43:25.195 +01:00 [INF] Authentification avec l'utilisateur 'apikey'...
2026-01-08 17:43:25.635 +01:00 [INF] Envoi de l'email à 'orichekaya2+@gmail.com'...
2026-01-08 17:43:26.609 +01:00 [INF] Email envoyé avec succès.
2026-01-08 17:43:26.624 +01:00 [INF] Connexion au serveur SMTP smtp.sendgrid.net sur le port 587 avec l'option "StartTls"...
2026-01-08 17:43:28.014 +01:00 [INF] Authentification avec l'utilisateur 'apikey'...
2026-01-08 17:43:28.241 +01:00 [INF] Envoi de l'email à 'orichekaya@gmail.com'...
2026-01-08 17:43:29.044 +01:00 [INF] Email envoyé avec succès.
2026-01-08 17:43:29.051 +01:00 [INF] HTTP POST /api/auth/register responded 200 in 6067.2134 ms
2026-01-08 17:44:44.749 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__get_Item_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__get_Item_0
2026-01-08 17:44:44.767 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = Int64), @p1='?' (DbType = Boolean), @p2='?' (DbType = Int32), @p3='?' (Size = 60), @p4='?' (Size = 6), @p5='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [clients] SET [DateModification] = @p0, [IsVerified] = @p1, [NiveauValidation] = @p2, [UtilisateurModification] = @p3, [VerificationCode] = @p4, [VerificationTokenExpiry] = @p5
OUTPUT 1
WHERE [Id] = @p6;
2026-01-08 17:44:44.773 +01:00 [INF] HTTP POST /api/auth/confirm-account responded 200 in 44.5981 ms
2026-01-08 17:47:08.165 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Id] = @__userId_Value_0
2026-01-08 17:47:08.180 +01:00 [INF] HTTP POST /api/auth/connect-by-token responded 200 in 60.8027 ms
2026-01-08 17:47:37.365 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Email_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[Adresse], [c].[Bp], [c].[ChangementMotPasse], [c].[Code], [c].[ContactFonction], [c].[ContactNom], [c].[ContactTelephone], [c].[DateCreation], [c].[DateModification], [c].[Desactive], [c].[Email], [c].[IsVerified], [c].[MotPasse], [c].[NiveauValidation], [c].[Pays], [c].[RaisonSociale], [c].[RegistreCommerce], [c].[Remarques], [c].[TypeClient], [c].[UtilisateurCreation], [c].[UtilisateurModification], [c].[VerificationCode], [c].[VerificationTokenExpiry], [c].[Ville]
FROM [clients] AS [c]
WHERE [c].[Email] = @__request_Email_0
2026-01-08 17:47:37.646 +01:00 [INF] HTTP POST /api/auth/login responded 200 in 322.8296 ms
2026-01-08 17:48:40.932 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_Libelle_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [dossiers] AS [d]
        WHERE [d].[Libelle] = @__request_Libelle_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2026-01-08 17:48:40.962 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'NouveauDossier'
2026-01-08 17:48:41.120 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?' (DbType = Int64), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Guid), @p8='?' (Size = 120), @p9='?' (Size = 30), @p10='?' (Size = 4000), @p11='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [dossiers] ([Id], [DateCreation], [DateModification], [DateOuverture], [IdAgentInstructeur], [IdClient], [IdModeReglement], [IdStatut], [Libelle], [Numero], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
2026-01-08 17:48:41.223 +01:00 [INF] Executed DbCommand (62ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 36), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2026-01-08 17:48:41.368 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [dossiers]
OUTPUT 1
WHERE [Id] = @p0;
2026-01-08 17:48:41.380 +01:00 [ERR] Échec de l'importation du document via la procédure stockée. La création du dossier a été annulée.
System.Exception: Erreur SQL lors de l'import: Chargement en masse impossible car le fichier "C:\Users\Lenovo\AppData\Local\Temp\arpce_uploads\b7bbe0f0-fe72-48b3-8c35-f8ee935ea96a.pdf" est impossible à ouvrir. Code d'erreur du système d'exploitation 5(Accès refusé.). (Code: 4861)
   at FrontOffice.Infrastructure.Services.DatabaseFileStorageProvider.ImportDocumentDossierAsync(IFormFile file, String nom, Byte type, Guid dossierId) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Infrastructure\Services\DatabaseFileStorageProvider.cs:line 56
   at FrontOffice.Application.Features.Demandes.Commands.CreateDossier.CreateDossierCommandHandler.Handle(CreateDossierCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Demandes\Commands\CreateDossier\CreateDossierCommandHandler.cs:line 87
2026-01-08 17:48:41.504 +01:00 [ERR] HTTP POST /api/dossiers responded 500 in 744.2350 ms
System.InvalidOperationException: Échec de la création du document : Erreur SQL lors de l'import: Chargement en masse impossible car le fichier "C:\Users\Lenovo\AppData\Local\Temp\arpce_uploads\b7bbe0f0-fe72-48b3-8c35-f8ee935ea96a.pdf" est impossible à ouvrir. Code d'erreur du système d'exploitation 5(Accès refusé.). (Code: 4861)
   at FrontOffice.Application.Features.Demandes.Commands.CreateDossier.CreateDossierCommandHandler.Handle(CreateDossierCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Demandes\Commands\CreateDossier\CreateDossierCommandHandler.cs:line 101
   at FrontOffice.Api.Controllers.DossiersController.CreateDossier(CreateDossierCommand command) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\DossiersController.cs:line 138
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2026-01-08 17:49:14.022 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__request_Libelle_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [dossiers] AS [d]
        WHERE [d].[Libelle] = @__request_Libelle_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2026-01-08 17:49:14.029 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'NouveauDossier'
2026-01-08 17:49:14.041 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?' (DbType = Int64), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Guid), @p8='?' (Size = 120), @p9='?' (Size = 30), @p10='?' (Size = 4000), @p11='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [dossiers] ([Id], [DateCreation], [DateModification], [DateOuverture], [IdAgentInstructeur], [IdClient], [IdModeReglement], [IdStatut], [Libelle], [Numero], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
2026-01-08 17:49:14.062 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 36), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2026-01-08 17:49:14.160 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [dossiers]
OUTPUT 1
WHERE [Id] = @p0;
2026-01-08 17:49:14.170 +01:00 [ERR] Échec de l'importation du document via la procédure stockée. La création du dossier a été annulée.
System.Exception: Erreur SQL lors de l'import: Chargement en masse impossible car le fichier "C:\Users\Lenovo\AppData\Local\Temp\arpce_uploads\db55fcc7-0639-42a0-a057-214e95906e94.pdf" est impossible à ouvrir. Code d'erreur du système d'exploitation 5(Accès refusé.). (Code: 4861)
   at FrontOffice.Infrastructure.Services.DatabaseFileStorageProvider.ImportDocumentDossierAsync(IFormFile file, String nom, Byte type, Guid dossierId) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Infrastructure\Services\DatabaseFileStorageProvider.cs:line 56
   at FrontOffice.Application.Features.Demandes.Commands.CreateDossier.CreateDossierCommandHandler.Handle(CreateDossierCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Demandes\Commands\CreateDossier\CreateDossierCommandHandler.cs:line 87
2026-01-08 17:49:14.263 +01:00 [ERR] HTTP POST /api/dossiers responded 500 in 284.3750 ms
System.InvalidOperationException: Échec de la création du document : Erreur SQL lors de l'import: Chargement en masse impossible car le fichier "C:\Users\Lenovo\AppData\Local\Temp\arpce_uploads\db55fcc7-0639-42a0-a057-214e95906e94.pdf" est impossible à ouvrir. Code d'erreur du système d'exploitation 5(Accès refusé.). (Code: 4861)
   at FrontOffice.Application.Features.Demandes.Commands.CreateDossier.CreateDossierCommandHandler.Handle(CreateDossierCommand request, CancellationToken cancellationToken) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Application\Features\Demandes\Commands\CreateDossier\CreateDossierCommandHandler.cs:line 101
   at FrontOffice.Api.Controllers.DossiersController.CreateDossier(CreateDossierCommand command) in D:\CDS\work_space\arpce-homologation-backends-cds\arpce-homologation-frontOffice\FrontOffice.Api\Controllers\DossiersController.cs:line 138
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2026-01-08 18:01:14.412 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__request_Libelle_0='?' (Size = 120)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [dossiers] AS [d]
        WHERE [d].[Libelle] = @__request_Libelle_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2026-01-08 18:01:14.433 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[Code], [s].[Libelle]
FROM [statuts] AS [s]
WHERE [s].[Code] = N'NouveauDossier'
2026-01-08 18:01:14.456 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?' (DbType = Int64), @p3='?' (DbType = Int64), @p4='?' (DbType = Guid), @p5='?' (DbType = Guid), @p6='?' (DbType = Guid), @p7='?' (DbType = Guid), @p8='?' (Size = 120), @p9='?' (Size = 30), @p10='?' (Size = 4000), @p11='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [dossiers] ([Id], [DateCreation], [DateModification], [DateOuverture], [IdAgentInstructeur], [IdClient], [IdModeReglement], [IdStatut], [Libelle], [Numero], [UtilisateurCreation], [UtilisateurModification])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
2026-01-08 18:01:14.633 +01:00 [INF] Executed DbCommand (149ms) [Parameters=[@fichier='?' (Size = 89), @nom='?' (Size = 36), @type='?' (Size = 1) (DbType = Byte), @IDDossier='?' (DbType = Guid), @IDDocument='?' (Direction = Output) (DbType = Guid), @errNumero='?' (Direction = Output) (DbType = Int32), @errMessage='?' (Size = 500) (Direction = Output)], CommandType='"Text"', CommandTimeout='30']
EXEC ImporterDocumentDossier @fichier, @nom, @type, @IDDossier, @IDDocument OUT, @errNumero OUT, @errMessage OUT
2026-01-08 18:01:14.691 +01:00 [INF] HTTP POST /api/dossiers responded 201 in 311.0247 ms
